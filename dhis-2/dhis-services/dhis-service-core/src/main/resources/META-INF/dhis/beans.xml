<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:aop="http://www.springframework.org/schema/aop"
  xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.0.xsd">
  
  <!-- Store definitions -->
  <bean id="org.hisp.dhis.dataentryform.DataEntryFormAssociationStore"
    class="org.hisp.dhis.dataentryform.hibernate.HibernateDataEntryFormAssociationStore">
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  
   <bean id="org.hisp.dhis.dataentryform.DataEntryFormStore"
    class="org.hisp.dhis.dataentryform.hibernate.HibernateDataEntryFormStore">
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>

  <bean id="org.hisp.dhis.customvalue.CustomValueStore"
    class="org.hisp.dhis.customvalue.hibernate.HibernateCustomValueStore">
    <property name="clazz" value="org.hisp.dhis.customvalue.CustomValue"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>

  <bean id="org.hisp.dhis.dataelement.DataElementStore"
    class="org.hisp.dhis.dataelement.hibernate.HibernateDataElementStore">
    <property name="sessionFactory" ref="sessionFactory"/>
	<property name="statementManager" ref="statementManager"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataelement.DataElementGroupStore"
    class="org.hisp.dhis.hibernate.HibernateGenericStore">
    <property name="clazz" value="org.hisp.dhis.dataelement.DataElementGroup"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataelement.DataElementGroupSetStore"
    class="org.hisp.dhis.hibernate.HibernateGenericStore">
    <property name="clazz" value="org.hisp.dhis.dataelement.DataElementGroupSet"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  
  <bean id="org.hisp.dhis.datadictionary.DataDictionaryStore"
    class="org.hisp.dhis.hibernate.HibernateGenericStore">
    <property name="clazz" value="org.hisp.dhis.datadictionary.DataDictionary"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  
  <bean id="org.hisp.dhis.datavalue.DataValueStore"
    class="org.hisp.dhis.datavalue.hibernate.HibernateDataValueStore">
    <property name="sessionFactory" ref="sessionFactory"/>
    <property name="statementManager" ref="statementManager"/>
    <property name="periodStore" 
      ref="org.hisp.dhis.period.PeriodStore"/>
  </bean>
  
  <bean id="org.hisp.dhis.indicator.IndicatorStore"
    class="org.hisp.dhis.indicator.hibernate.HibernateIndicatorStore">
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
	
  <bean id="org.hisp.dhis.indicator.IndicatorTypeStore"
    class="org.hisp.dhis.hibernate.HibernateGenericStore">
    <property name="clazz" value="org.hisp.dhis.indicator.IndicatorType"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
    
  <bean id="org.hisp.dhis.indicator.IndicatorGroupStore"
    class="org.hisp.dhis.hibernate.HibernateGenericStore">
    <property name="clazz" value="org.hisp.dhis.indicator.IndicatorGroup"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
    
  <bean id="org.hisp.dhis.indicator.IndicatorGroupSetStore"
    class="org.hisp.dhis.hibernate.HibernateGenericStore">
    <property name="clazz" value="org.hisp.dhis.indicator.IndicatorGroupSet"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
    
  <bean id="org.hisp.dhis.period.PeriodStore"
    class="org.hisp.dhis.period.hibernate.HibernatePeriodStore">
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  
  <bean id="org.hisp.dhis.source.SourceStore"
    class="org.hisp.dhis.source.hibernate.HibernateSourceStore">
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataset.DataSetStore"
    class="org.hisp.dhis.dataset.hibernate.HibernateDataSetStore">
    <property name="sessionFactory" ref="sessionFactory"/>
    <property name="periodStore"
      ref="org.hisp.dhis.period.PeriodStore"/>
  </bean>

  <bean id="org.hisp.dhis.dataset.CompleteDataSetRegistrationStore"
    class="org.hisp.dhis.dataset.hibernate.HibernateCompleteDataSetRegistrationStore"> 
    <property name="sessionFactory" ref="sessionFactory"/>
    <property name="periodService"
      ref="org.hisp.dhis.period.PeriodService"/>
  </bean>
  
 <bean id="org.hisp.dhis.minmax.MinMaxDataElementStore"
    class="org.hisp.dhis.minmax.hibernate.HibernateMinMaxDataElementStore">
    <property name="clazz" value="org.hisp.dhis.minmax.MinMaxDataElement"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  
  <bean id="org.hisp.dhis.expression.ExpressionStore"
    class="org.hisp.dhis.hibernate.HibernateGenericStore">
    <property name="clazz" value="org.hisp.dhis.expression.Expression"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  
  <bean id="org.hisp.dhis.validation.ValidationRuleStore"
    class="org.hisp.dhis.hibernate.HibernateGenericStore">
    <property name="clazz" value="org.hisp.dhis.validation.ValidationRule"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  
  <bean id="org.hisp.dhis.validation.ValidationRuleGroupStore"
    class="org.hisp.dhis.hibernate.HibernateGenericStore">
    <property name="clazz" value="org.hisp.dhis.validation.ValidationRuleGroup"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
	
  <bean id="org.hisp.dhis.dataelement.DataElementCategoryStore"
    class="org.hisp.dhis.hibernate.HibernateGenericStore">
    <property name="clazz" value="org.hisp.dhis.dataelement.DataElementCategory"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>  
  
  <bean id="org.hisp.dhis.dataelement.DataElementCategoryOptionStore"
    class="org.hisp.dhis.hibernate.HibernateGenericStore">
    <property name="clazz" value="org.hisp.dhis.dataelement.DataElementCategoryOption"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
	
  <bean id="org.hisp.dhis.dataelement.DataElementCategoryComboStore"
    class="org.hisp.dhis.hibernate.HibernateGenericStore">
    <property name="clazz" value="org.hisp.dhis.dataelement.DataElementCategoryCombo"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
	
  <bean id="org.hisp.dhis.dataelement.DataElementCategoryOptionComboStore"
    class="org.hisp.dhis.hibernate.HibernateGenericStore">
    <property name="clazz" value="org.hisp.dhis.dataelement.DataElementCategoryOptionCombo"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataset.SectionStore"
    class="org.hisp.dhis.dataset.hibernate.HibernateSectionStore">
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  
  <bean id="org.hisp.dhis.organisationunit.OrganisationUnitStore"
    class="org.hisp.dhis.organisationunit.hibernate.HibernateOrganisationUnitStore">
    <property name="sessionFactory" ref="sessionFactory"/>
    <property name="statementManager" ref="statementManager"/>
    <property name="jdbcTemplate" ref="jdbcTemplate"/>
  </bean>

  <bean id="org.hisp.dhis.organisationunit.OrganisationUnitGroupStore"
    class="org.hisp.dhis.hibernate.HibernateGenericStore">
    <property name="clazz" value="org.hisp.dhis.organisationunit.OrganisationUnitGroup"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  
  <bean id="org.hisp.dhis.organisationunit.OrganisationUnitGroupSetStore"
    class="org.hisp.dhis.hibernate.HibernateGenericStore">
    <property name="clazz" value="org.hisp.dhis.organisationunit.OrganisationUnitGroupSet"/>
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataanalysis.jdbc.DataAnalysisStore"
    class="org.hisp.dhis.dataanalysis.jdbc.JdbcDataAnalysisStore">
    <property name="statementManager" ref="statementManager"/>
    <property name="statementBuilder" ref="statementBuilder"/>
  </bean>
    
  <!-- Service definitions -->

  <bean id="org.hisp.dhis.customvalue.CustomValueService"
    class="org.hisp.dhis.customvalue.DefaultCustomValueService">
    <property name="customValueStore"
      ref="org.hisp.dhis.customvalue.CustomValueStore"/>
  </bean>

  <bean id="org.hisp.dhis.datavalue.DataValueService"
    class="org.hisp.dhis.datavalue.DefaultDataValueService">
    <property name="dataValueStore"
      ref="org.hisp.dhis.datavalue.DataValueStore"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataelement.DataElementService"
    class="org.hisp.dhis.dataelement.DefaultDataElementService">
    <property name="dataElementStore"
      ref="org.hisp.dhis.dataelement.DataElementStore"/>
	<property name="dataElementGroupStore"
	  ref="org.hisp.dhis.dataelement.DataElementGroupStore"/>
    <property name="dataElementGroupSetStore"
      ref="org.hisp.dhis.dataelement.DataElementGroupSetStore"/>	
    <property name="i18nService"
      ref="org.hisp.dhis.i18n.I18nService"/>
  </bean>
  
  <bean id="org.hisp.dhis.minmax.MinMaxDataElementService"
    class="org.hisp.dhis.minmax.DefaultMinMaxDataElementService">
    <property name="minMaxDataElementStore"
      ref="org.hisp.dhis.minmax.MinMaxDataElementStore"/>
  </bean>
  
  <bean id="org.hisp.dhis.datadictionary.DataDictionaryService"
    class="org.hisp.dhis.datadictionary.DefaultDataDictionaryService">
    <property name="dataDictionaryStore"
      ref="org.hisp.dhis.datadictionary.DataDictionaryStore"/>
  </bean>
 
  <bean id="org.hisp.dhis.indicator.IndicatorService"
	class="org.hisp.dhis.indicator.DefaultIndicatorService">
   <property name="indicatorStore"
     ref="org.hisp.dhis.indicator.IndicatorStore"/>
   <property name="indicatorTypeStore"
	 ref="org.hisp.dhis.indicator.IndicatorTypeStore"/>
   <property name="indicatorGroupStore"
	 ref="org.hisp.dhis.indicator.IndicatorGroupStore"/>
   <property name="indicatorGroupSetStore"
	 ref="org.hisp.dhis.indicator.IndicatorGroupSetStore"/>
   <property name="i18nService"
     ref="org.hisp.dhis.i18n.I18nService"/>
  </bean>

  <bean id="org.hisp.dhis.period.PeriodService"
    class="org.hisp.dhis.period.DefaultPeriodService">
    <property name="periodStore"
      ref="org.hisp.dhis.period.PeriodStore"/>
  </bean>
	
  <bean id="org.hisp.dhis.dataset.DataSetService"
    class="org.hisp.dhis.dataset.DefaultDataSetService">
    <property name="dataSetStore"
      ref="org.hisp.dhis.dataset.DataSetStore"/>
    <property name="dataEntryFormService"
      ref="org.hisp.dhis.dataentryform.DataEntryFormService"/>
    <property name="i18nService"
      ref="org.hisp.dhis.i18n.I18nService"/>
  </bean>

  <bean id="org.hisp.dhis.dataset.CompleteDataSetRegistrationService"
    class="org.hisp.dhis.dataset.DefaultCompleteDataSetRegistrationService">    
    <property name="completeDataSetRegistrationStore"
      ref="org.hisp.dhis.dataset.CompleteDataSetRegistrationStore"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataset.SectionService"
    class="org.hisp.dhis.dataset.DefaultSectionService">
    <property name="sectionStore"
      ref="org.hisp.dhis.dataset.SectionStore"/>
  </bean>
  
   <bean id="org.hisp.dhis.dataentryform.DataEntryFormService"
    class="org.hisp.dhis.dataentryform.DefaultDataEntryFormService">
    <property name="dataEntryFormStore"
      ref="org.hisp.dhis.dataentryform.DataEntryFormStore"/>
    <property name="dataEntryFormAssociationService"
      ref="org.hisp.dhis.dataentryform.DataEntryFormAssociationService"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataentryform.DataEntryFormAssociationService"
    class="org.hisp.dhis.dataentryform.DefaultDataEntryFormAssociationService">
    <property name="dataEntryFormAssociationStore"
      ref="org.hisp.dhis.dataentryform.DataEntryFormAssociationStore"/>
  </bean>
    
 <bean id="org.hisp.dhis.expression.ExpressionService"
    class="org.hisp.dhis.expression.DefaultExpressionService">
    <property name="expressionStore"
      ref="org.hisp.dhis.expression.ExpressionStore"/>
    <property name="dataElementService"
      ref="org.hisp.dhis.dataelement.DataElementService"/>
    <property name="dataValueService"
      ref="org.hisp.dhis.datavalue.DataValueService"/>
    <property name="categoryService"
      ref="org.hisp.dhis.dataelement.DataElementCategoryService"/>
  </bean>

  <bean id="org.hisp.dhis.validation.ValidationRuleService"
    class="org.hisp.dhis.validation.DefaultValidationRuleService">
    <property name="validationRuleStore"
      ref="org.hisp.dhis.validation.ValidationRuleStore"/>
    <property name="validationRuleGroupStore"
      ref="org.hisp.dhis.validation.ValidationRuleGroupStore"/>
    <property name="expressionService"
      ref="org.hisp.dhis.expression.ExpressionService"/>
    <property name="periodService"
      ref="org.hisp.dhis.period.PeriodService"/>
  </bean>
	
  <bean id="org.hisp.dhis.dataelement.DataElementCategoryService"
    class="org.hisp.dhis.dataelement.DefaultDataElementCategoryService">
    <property name="dataElementCategoryStore"
      ref="org.hisp.dhis.dataelement.DataElementCategoryStore"/>
    <property name="dataElementCategoryOptionStore"
      ref="org.hisp.dhis.dataelement.DataElementCategoryOptionStore"/>
    <property name="dataElementCategoryComboStore"
      ref="org.hisp.dhis.dataelement.DataElementCategoryComboStore"/>
    <property name="dataElementCategoryOptionComboStore"
      ref="org.hisp.dhis.dataelement.DataElementCategoryOptionComboStore"/>  
    <property name="dataElementService"
      ref="org.hisp.dhis.dataelement.DataElementService"/>
  </bean>
  
  <bean id="org.hisp.dhis.dimension.DimensionService"
	class="org.hisp.dhis.dimension.DefaultDimensionService">
    <property name="dataElementService"
      ref="org.hisp.dhis.dataelement.DataElementService"/>
	<property name="categoryService"
      ref="org.hisp.dhis.dataelement.DataElementCategoryService"/>
  </bean>
    
  <bean id="org.hisp.dhis.organisationunit.OrganisationUnitService"
    class="org.hisp.dhis.organisationunit.DefaultOrganisationUnitService">
    <property name="sourceStore"
      ref="org.hisp.dhis.source.SourceStore"/>
    <property name="organisationUnitStore"
      ref="org.hisp.dhis.organisationunit.OrganisationUnitStore"/>
  </bean>

  <bean id="org.hisp.dhis.organisationunit.OrganisationUnitGroupService"
    class="org.hisp.dhis.organisationunit.DefaultOrganisationUnitGroupService">
    <property name="organisationUnitGroupStore"
      ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupStore"/>
    <property name="organisationUnitGroupSetStore"
      ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupSetStore"/>
  </bean>
   
  <bean id="org.hisp.dhis.dataanalysis.StdDevOutlierAnalysisService" 
    class="org.hisp.dhis.dataanalysis.StdDevOutlierAnalysisService">
    <property name="organisationUnitService"
      ref="org.hisp.dhis.organisationunit.OrganisationUnitService"/>
    <property name="dataAnalysisStore"
      ref="org.hisp.dhis.dataanalysis.jdbc.DataAnalysisStore"/>
  </bean>

  <bean id="org.hisp.dhis.dataanalysis.MinMaxOutlierAnalysisService"
    class="org.hisp.dhis.dataanalysis.MinMaxOutlierAnalysisService">
    <property name="organisationUnitService"
      ref="org.hisp.dhis.organisationunit.OrganisationUnitService"/>
    <property name="minMaxDataElementService"
      ref="org.hisp.dhis.minmax.MinMaxDataElementService" />
    <property name="dataAnalysisStore"
      ref="org.hisp.dhis.dataanalysis.jdbc.DataAnalysisStore"/>  
  </bean>
  
  <bean id="org.hisp.dhis.dataanalysis.GapAnalysisService"
    class="org.hisp.dhis.dataanalysis.GapAnalysisService">
    <property name="organisationUnitService"
      ref="org.hisp.dhis.organisationunit.OrganisationUnitService"/>
    <property name="dataAnalysisStore"
      ref="org.hisp.dhis.dataanalysis.jdbc.DataAnalysisStore"/>  
  </bean>
  
  <bean id="org.hisp.dhis.dataanalysis.FollowupAnalysisService"
    class="org.hisp.dhis.dataanalysis.FollowupAnalysisService">
    <property name="dataAnalysisStore"
      ref="org.hisp.dhis.dataanalysis.jdbc.DataAnalysisStore"/>  
  </bean>
  
  <bean id="dataAnalysisServiceProvider"
	class="org.hisp.dhis.common.ServiceProvider">
	<property name="services">
		<map>
			<entry>
				<key><value>stddevoutlier</value></key>
				<ref bean="org.hisp.dhis.dataanalysis.StdDevOutlierAnalysisService"/>
			</entry>
            <entry>
                <key><value>minmaxoutlier</value></key>
                <ref bean="org.hisp.dhis.dataanalysis.MinMaxOutlierAnalysisService"/>
            </entry>
            <entry>
                <key><value>gap</value></key>
                <ref bean="org.hisp.dhis.dataanalysis.GapAnalysisService"/>
            </entry>
            <entry>
                <key><value>followup</value></key>
                <ref bean="org.hisp.dhis.dataanalysis.FollowupAnalysisService"/>
            </entry>
		</map>		
	</property>
  </bean>
  
  <!-- Startup routine definitions -->
	
  <bean id="org.hisp.dhis.dataentryform.DataEntryFormPopulator"
    class="org.hisp.dhis.dataentryform.DataEntryFormPopulator">
  	<property name="statementManager" ref="statementManager"/>
    <property name="runlevel" value="1"/>
  </bean>
	
  <bean id="org.hisp.dhis.period.PeriodTypePopulator"
    class="org.hisp.dhis.period.PeriodTypePopulator">
    <property name="periodStore"
      ref="org.hisp.dhis.period.PeriodStore"/>
    <property name="runlevel" value="1"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataelement.DataElementDefaultDimensionPopulator"
    class="org.hisp.dhis.dataelement.DataElementDefaultDimensionPopulator">
    <property name="dataElementService"
      ref="org.hisp.dhis.dataelement.DataElementService"/>
    <property name="categoryService"
      ref="org.hisp.dhis.dataelement.DataElementCategoryService"/>
    <property name="runlevel" value="2"/>
  </bean>
	  
  <bean id="org.hisp.dhis.dataelement.OptionsCategoriesDefaultSortOrderPopulator"
    class="org.hisp.dhis.dataelement.OptionsCategoriesDefaultSortOrderPopulator">
    <property name="statementManager" ref="statementManager"/>
    <property name="runlevel" value="1"/>
	<property name="skipInTests" value="true"/>
  </bean>
	
  <bean id="org.hisp.dhis.expression.MultiDimensionExpressionUpgrader"
    class="org.hisp.dhis.expression.MultiDimensionExpressionUpgrader">
    <property name="expressionService"
      ref="org.hisp.dhis.expression.ExpressionService"/>
    <property name="indicatorService"
      ref="org.hisp.dhis.indicator.IndicatorService"/>
    <property name="categoryService"
      ref="org.hisp.dhis.dataelement.DataElementCategoryService"/> 
    <property name="runlevel" value="2"/>
    <property name="skipInTests" value="true"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataset.DataSetShortNamePopulator"
    class="org.hisp.dhis.dataset.DataSetShortNamePopulator">
    <property name="dataSetService"
      ref="org.hisp.dhis.dataset.DataSetService"/>    
    <property name="skipInTests" value="true"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataelement.UuidPopulator"
    class="org.hisp.dhis.dataelement.UuidPopulator">
    <property name="categoryService"
      ref="org.hisp.dhis.dataelement.DataElementCategoryService"/>
    <property name="dataElementService"
      ref="org.hisp.dhis.dataelement.DataElementService"/>
    <property name="skipInTests" value="true"/>
  </bean>
  
  <bean id="org.hisp.dhis.organisationunit.OrganisationUnitHierarchyVerifier"
    class="org.hisp.dhis.organisationunit.OrganisationUnitHierarchyVerifier">
    <property name="organisationUnitService"
      ref="org.hisp.dhis.organisationunit.OrganisationUnitService"/>
  </bean>
  
  <bean id="org.hisp.dhis.organisationunit.OrganisationUnitGroupSetPopulator"
    class="org.hisp.dhis.organisationunit.OrganisationUnitGroupSetPopulator">
    <property name="organisationUnitGroupService"
      ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService"/>
    <property name="skipInTests" value="true"/>
  </bean>
    
  <bean class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
    <property name="targetObject"
      ref="org.hisp.dhis.system.startup.StartupRoutineExecutor"/>
    <property name="targetMethod" value="addStartupRoutines"/>
    <property name="arguments">
      <list>
        <list>
          <ref local="org.hisp.dhis.dataelement.OptionsCategoriesDefaultSortOrderPopulator"/>
          <ref local="org.hisp.dhis.period.PeriodTypePopulator"/>
          <ref local="org.hisp.dhis.dataelement.DataElementDefaultDimensionPopulator"/>
          <ref local="org.hisp.dhis.expression.MultiDimensionExpressionUpgrader"/>
          <ref local="org.hisp.dhis.dataset.DataSetShortNamePopulator"/>
          <ref local="org.hisp.dhis.dataelement.UuidPopulator"/>
		  <ref local="org.hisp.dhis.organisationunit.OrganisationUnitHierarchyVerifier"/>
          <ref local="org.hisp.dhis.organisationunit.OrganisationUnitGroupSetPopulator"/>
          <ref local="org.hisp.dhis.dataentryform.DataEntryFormPopulator"/>
        </list>
      </list>
    </property>
  </bean>

  <!-- DeletionHandlers -->
  
  <bean id="org.hisp.dhis.dataentryform.DataEntryFormDeletionHandler"
    class="org.hisp.dhis.dataentryform.DataEntryFormDeletionHandler">
    <property name="dataEntryFormService"
      ref="org.hisp.dhis.dataentryform.DataEntryFormService"/>
    <property name="deletionManager"
      ref="org.hisp.dhis.system.deletion.DeletionManager"/>
  </bean>
    
  <bean id="org.hisp.dhis.datadictionary.DataDictionaryDeletionHandler"
    class="org.hisp.dhis.datadictionary.DataDictionaryDeletionHandler">
    <property name="dataDictionaryService"
      ref="org.hisp.dhis.datadictionary.DataDictionaryService"/>
  </bean>
	
  <bean id="org.hisp.dhis.dataelement.DataElementDeletionHandler"
    class="org.hisp.dhis.dataelement.DataElementDeletionHandler">
    <property name="dataElementService"
      ref="org.hisp.dhis.dataelement.DataElementService"/>
    <property name="categoryService"
      ref="org.hisp.dhis.dataelement.DataElementCategoryService"/>
  </bean>
	
  <bean id="org.hisp.dhis.dataelement.DataElementGroupDeletionHandler"
    class="org.hisp.dhis.dataelement.DataElementGroupDeletionHandler">
    <property name="dataElementService"
      ref="org.hisp.dhis.dataelement.DataElementService"/>
  </bean>  
  
  <bean id="org.hisp.dhis.dataelement.DataElementCategoryOptionDeletionHandler"
    class="org.hisp.dhis.dataelement.DataElementCategoryOptionDeletionHandler">
    <property name="categoryService"
      ref="org.hisp.dhis.dataelement.DataElementCategoryService"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataelement.DataElementCategoryOptionComboDeletionHandler"
    class="org.hisp.dhis.dataelement.DataElementCategoryOptionComboDeletionHandler">
    <property name="categoryService"
      ref="org.hisp.dhis.dataelement.DataElementCategoryService"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataelement.DataElementCategoryComboDeletionHandler"
    class="org.hisp.dhis.dataelement.DataElementCategoryComboDeletionHandler">
    <property name="categoryService"
      ref="org.hisp.dhis.dataelement.DataElementCategoryService"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataset.DataSetDeletionHandler"
    class="org.hisp.dhis.dataset.DataSetDeletionHandler">
    <property name="dataSetService"
      ref="org.hisp.dhis.dataset.DataSetService"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataset.CompleteDataSetRegistrationDeletionHandler"
    class="org.hisp.dhis.dataset.CompleteDataSetRegistrationDeletionHandler">
    <property name="completeDataSetRegistrationService"
      ref="org.hisp.dhis.dataset.CompleteDataSetRegistrationService"/>
    <property name="jdbcTemplate" ref="jdbcTemplate"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataset.SectionDeletionHandler"
    class="org.hisp.dhis.dataset.SectionDeletionHandler">
    <property name="sectionService"
      ref="org.hisp.dhis.dataset.SectionService"/>
    <property name="deletionManager"
      ref="org.hisp.dhis.system.deletion.DeletionManager"/>
  </bean>
  
  <bean id="org.hisp.dhis.dataset.FrequencyOverrideAssociationDeletionHandler"
    class="org.hisp.dhis.dataset.FrequencyOverrideAssociationDeletionHandler">
    <property name="dataSetService"
      ref="org.hisp.dhis.dataset.DataSetService"/>
    <property name="deletionManager"
      ref="org.hisp.dhis.system.deletion.DeletionManager"/>
  </bean>
  
  <bean id="org.hisp.dhis.expression.ExpressionDeletionHandler"
    class="org.hisp.dhis.expression.ExpressionDeletionHandler">
    <property name="expressionService"
      ref="org.hisp.dhis.expression.ExpressionService"/>
  </bean>
  
  <bean id="org.hisp.dhis.indicator.IndicatorDeletionHandler"
    class="org.hisp.dhis.indicator.IndicatorDeletionHandler">
    <property name="indicatorService"
      ref="org.hisp.dhis.indicator.IndicatorService"/>
    <property name="deletionManager"
      ref="org.hisp.dhis.system.deletion.DeletionManager"/>
  </bean>
  
  <bean id="org.hisp.dhis.indicator.IndicatorGroupDeletionHandler"
    class="org.hisp.dhis.indicator.IndicatorGroupDeletionHandler">
    <property name="indicatorService"
      ref="org.hisp.dhis.indicator.IndicatorService"/>
  </bean>
  
  <bean id="org.hisp.dhis.minmax.MinMaxDataElementDeletionHandler"
    class="org.hisp.dhis.minmax.MinMaxDataElementDeletionHandler">
    <property name="minMaxDataElementService"
      ref="org.hisp.dhis.minmax.MinMaxDataElementService"/>
    <property name="deletionManager"
      ref="org.hisp.dhis.system.deletion.DeletionManager"/>
  </bean>
  
  <bean id="org.hisp.dhis.validation.ValidationRuleDeletionHandler"
    class="org.hisp.dhis.validation.ValidationRuleDeletionHandler">
    <property name="validationRuleService"
      ref="org.hisp.dhis.validation.ValidationRuleService"/>
    <property name="deletionManager"
      ref="org.hisp.dhis.system.deletion.DeletionManager"/>
  </bean>
  
  <bean id="org.hisp.dhis.validation.ValidationRuleGroupDeletionHandler"
    class="org.hisp.dhis.validation.ValidationRuleGroupDeletionHandler">
    <property name="validationRuleService"
      ref="org.hisp.dhis.validation.ValidationRuleService"/>
  </bean>
  
  <bean id="org.hisp.dhis.datavalue.DataValueDeletionHandler"
    class="org.hisp.dhis.datavalue.DataValueDeletionHandler">
    <property name="jdbcTemplate" ref="jdbcTemplate"/>
  </bean>
  
  <bean id="org.hisp.dhis.organisationunit.OrganisationUnitGroupDeletionHandler"
    class="org.hisp.dhis.organisationunit.OrganisationUnitGroupDeletionHandler">
    <property name="organisationUnitGroupService"
      ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService"/>
  </bean>
  
  <bean id="org.hisp.dhis.organisationunit.OrganisationUnitGroupSetDeletionHandler"
    class="org.hisp.dhis.organisationunit.OrganisationUnitGroupSetDeletionHandler">
    <property name="organisationUnitGroupService"
      ref="org.hisp.dhis.organisationunit.OrganisationUnitGroupService"/>
  </bean>
    
  <!-- DeletionManager -->
  
  <bean class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
    <property name="targetObject" ref="org.hisp.dhis.system.deletion.DeletionManager"/>
    <property name="targetMethod" value="addDeletionHandlers"/>
    <property name="arguments">
	  <list>
        <list>
          <ref local="org.hisp.dhis.datadictionary.DataDictionaryDeletionHandler"/>
          <ref local="org.hisp.dhis.dataelement.DataElementDeletionHandler"/>
          <ref local="org.hisp.dhis.dataelement.DataElementGroupDeletionHandler"/>
          <ref local="org.hisp.dhis.dataelement.DataElementCategoryOptionDeletionHandler"/>        
          <ref local="org.hisp.dhis.dataelement.DataElementCategoryOptionComboDeletionHandler"/>
          <ref local="org.hisp.dhis.dataelement.DataElementCategoryComboDeletionHandler"/>
          <ref local="org.hisp.dhis.dataset.DataSetDeletionHandler"/>
          <ref local="org.hisp.dhis.dataset.CompleteDataSetRegistrationDeletionHandler"/>
          <ref local="org.hisp.dhis.dataset.SectionDeletionHandler"/>
          <ref local="org.hisp.dhis.dataentryform.DataEntryFormDeletionHandler"/>
          <ref local="org.hisp.dhis.dataset.FrequencyOverrideAssociationDeletionHandler"/>
          <ref local="org.hisp.dhis.expression.ExpressionDeletionHandler"/>
          <ref local="org.hisp.dhis.indicator.IndicatorDeletionHandler"/>
          <ref local="org.hisp.dhis.indicator.IndicatorGroupDeletionHandler"/>
          <ref local="org.hisp.dhis.minmax.MinMaxDataElementDeletionHandler"/>
          <ref local="org.hisp.dhis.validation.ValidationRuleDeletionHandler"/>
          <ref local="org.hisp.dhis.validation.ValidationRuleGroupDeletionHandler"/>
          <ref local="org.hisp.dhis.datavalue.DataValueDeletionHandler"/>
          <ref local="org.hisp.dhis.organisationunit.OrganisationUnitGroupDeletionHandler"/>
          <ref local="org.hisp.dhis.organisationunit.OrganisationUnitGroupSetDeletionHandler"/>
        </list>
      </list>
    </property>
  </bean>
  
  <!-- Startup -->
  
  <bean id="org.hisp.dhis.startup.TableCreator"
    class="org.hisp.dhis.startup.TableCreator">
    <property name="runlevel" value="3"/>
    <property name="jdbcTemplate" ref="jdbcTemplate"/>
    <property name="statementBuilder" ref="statementBuilder"/>
  </bean>
    
  <bean class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
    <property name="targetObject"
      ref="org.hisp.dhis.system.startup.StartupRoutineExecutor"/>
    <property name="targetMethod" value="addStartupRoutines"/>
    <property name="arguments">
      <list>
        <ref local="org.hisp.dhis.startup.TableCreator"/>
      </list>
    </property>
  </bean>
  
  <!-- AOP definitions -->
  
  <aop:config>
  
    <aop:aspect ref="deletionInterceptor">      
      <aop:before pointcut="execution( * org.hisp.dhis.datadictionary.DataDictionaryService.delete*(..) )" method="intercept"/>
      <aop:before pointcut="execution( * org.hisp.dhis.dataelement.DataElementService.delete*(..) )" method="intercept"/>
      <aop:before pointcut="execution( * org.hisp.dhis.dataelement.DataElementCategoryService.delete*(..) )" method="intercept"/>
      <aop:before pointcut="execution( * org.hisp.dhis.dataset.DataSetService.delete*(..) )" method="intercept"/>
      <aop:before pointcut="execution( * org.hisp.dhis.indicator.IndicatorService.delete*(..) )" method="intercept"/>
      <aop:before pointcut="execution( * org.hisp.dhis.expression.ExpressionService.delete*(..) )" method="intercept"/>
      <aop:before pointcut="execution( * org.hisp.dhis.minmax.MinMaxDataElementService.delete*(..) )" method="intercept"/>
      <aop:before pointcut="execution( * org.hisp.dhis.validation.ValidationRuleService.delete*(..) )" method="intercept"/>
      <aop:before pointcut="execution( * org.hisp.dhis.period.PeriodService.delete*(..) )" method="intercept"/>
	  <aop:before pointcut="execution( * org.hisp.dhis.organisationunit.OrganisationUnitService.delete*(..) )" method="intercept"/>
      <aop:before pointcut="execution( * org.hisp.dhis.organisationunit.OrganisationUnitGroupService.delete*(..) )" method="intercept"/>
    </aop:aspect>
      
    <aop:aspect ref="statementInterceptor">
      <aop:around pointcut="execution( * org.hisp.dhis.validation.ValidationRuleService.validate(..) )" method="intercept"/>
	  <aop:around pointcut="execution( * org.hisp.dhis.dataanalysis.DataAnalysisService.analyse(..) )" method="intercept"/>
    </aop:aspect>
    
	<!--
    <aop:aspect ref="i18nTranslationInterceptor">
      <aop:after-returning pointcut="execution( * org.hisp.dhis.dataelement.DataElementService.get*(..) )" method="intercept" returning="object"/>
      <aop:after-returning pointcut="execution( * org.hisp.dhis.dataelement.DataElementCategoryService.get*(..) )" method="intercept" returning="object"/>
      <aop:after-returning pointcut="execution( * org.hisp.dhis.indicator.IndicatorService.get*(..) )" method="intercept" returning="object"/>
      <aop:after-returning pointcut="execution( * org.hisp.dhis.datadictionary.DataDictionaryService.get*(..) )" method="intercept" returning="object"/>
      <aop:after-returning pointcut="execution( * org.hisp.dhis.dataset.DataSetService.get*(..) )" method="intercept" returning="object"/>
      <aop:after-returning pointcut="execution( * org.hisp.dhis.organisationunit.OrganisationUnitService.get*(..) )" method="intercept" returning="object"/>
      <aop:after-returning pointcut="execution( * org.hisp.dhis.organisationunit.OrganisationUnitGroupService.get*(..) )" method="intercept" returning="object"/>
    </aop:aspect>
	-->
	
  </aop:config>
  
</beans>
