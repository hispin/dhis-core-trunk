<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
	"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
	<class name="org.hisp.dhis.reportexcel.ReportExcel" table="reportexcels">
	
		<cache usage="read-write"/>
    
		<id name="id" column="reportexcelid">
			<generator class="native" />
		</id>
		<property name="name" not-null="true" unique="true"/>
		<property name="excelTemplateFile" column="exceltemplate" not-null="true" />
		<property name="periodRow" column="periodrow" />
		<property name="periodColumn" column="periodcolumn" />
		<property name="organisationRow" column="organisationrow" />
		<property name="organisationColumn" column="organisationcolumn" />
		<property name="group" column="reportgroup" not-null="true"/>

		<set name="reportExcelItems" lazy="false" cascade="all-delete-orphan" inverse="true">
			<key column="reportexcelid" />
			<one-to-many class="org.hisp.dhis.reportexcel.ReportExcelItem" />
		</set>

		<set name="organisationAssocitions" table="reportexcel_associations" lazy="false">
			<key column="reportexcelid" />
			<many-to-many class="org.hisp.dhis.organisationunit.OrganisationUnit"
				column="organisationid"  foreign-key="fk_reportexcel_organisation"/>
		</set>		
		
		<joined-subclass name="org.hisp.dhis.reportexcel.ReportExcelNormal" table="reportexcels_normal">
			<key column="reportexcelid" />			
		</joined-subclass>
		
		<joined-subclass name="org.hisp.dhis.reportexcel.ReportExcelPeriodColumnListing" table="reportexcels_periodcolumnlisting">
			<key column="reportexcelid" />		
			<set name="periodColumns" cascade="all" table="reportexcel_periodcolumns" lazy="false">
				<key column="reportexcelid"/>
				<one-to-many class="org.hisp.dhis.reportexcel.PeriodColumn"/>
			</set>	
		</joined-subclass>
		
		<joined-subclass name="org.hisp.dhis.reportexcel.ReportExcelCategory" table="reportexcels_category">
			<key column="reportexcelid"/>
			<list name="dataElementOrders" table="reportexcel_dataelementgrouporder" cascade="all" lazy="false">
				<key column="reportexcelid"/>
				<list-index base="0" column="dataelementgrouporder"/>
				<one-to-many class="org.hisp.dhis.reportexcel.DataElementGroupOrder"/>
		    </list>				
		</joined-subclass>
		
		<joined-subclass name="org.hisp.dhis.reportexcel.ReportExcelOganiztionGroupListing" table="reportexcels_organizationgrouplisting">			
			<key column="reportexcelid"/>			
			<list  name="organisationUnitGroups" table="reportexcel_organisationgroup">
				<key column="reportexcelid" />
				<list-index column="grouporder" base="0"/>				
				<many-to-many class="org.hisp.dhis.organisationunit.OrganisationUnitGroup" column="oganisationunitgroupid"
				foreign-key="fk_reportexcel_organisationgroup"/>				
			</list>		
			<map name="organisationUnitLevels" table="reportexcel_organisationunit_levels">
				<key column="reportexcelid"/>
				<index-many-to-many class="org.hisp.dhis.organisationunit.OrganisationUnitGroup" column="organisationunitgroupid" foreign-key="fk_organisationunitgroup_level"/>
				<many-to-many class="org.hisp.dhis.organisationunit.OrganisationUnitLevel" column="organisationunitlevelid" foreign-key="pk_organisationunitgroup_level"/>
			</map>
		</joined-subclass>
		
	</class>
</hibernate-mapping>
