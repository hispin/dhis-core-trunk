<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">

  <bean id="org.hisp.dhis.i18n.locale.LocaleManager" class="org.hisp.dhis.i18n.locale.UserSettingLocaleManager">
    <property name="userSettingService">
      <ref bean="org.hisp.dhis.user.UserSettingService" />
    </property>
    <property name="userSettingKey">
      <value>currentLocale</value>
    </property>
    <property name="defaultLocale">
      <value>en_GB</value>
    </property>
  </bean>

  <bean id="org.hisp.dhis.i18n.resourcebundle.ResourceBundleManager" class="org.hisp.dhis.i18n.resourcebundle.DefaultResourceBundleManager">
    <property name="globalResourceBundleName">
      <value>i18n_global</value>
    </property>
    <property name="specificResourceBundleName">
      <value>i18n_module</value>
    </property>
  </bean>

  <bean id="org.hisp.dhis.i18n.I18nManager" class="org.hisp.dhis.i18n.DefaultI18nManager">
    <property name="resourceBundleManager">
      <ref bean="org.hisp.dhis.i18n.resourcebundle.ResourceBundleManager" />
    </property>
    <property name="localeManager">
      <ref local="org.hisp.dhis.i18n.locale.LocaleManager" />
    </property>
  </bean>
  
  <!-- Upgrader -->

  <bean id="org.hisp.dhis.i18n.I18nUpgrader" class="org.hisp.dhis.i18n.I18nUpgrader">
    <property name="i18nService">
      <ref bean="org.hisp.dhis.i18n.I18nService" />
    </property>
    <property name="translationService">
      <ref bean="org.hisp.dhis.translation.TranslationService" />
    </property>
    <property name="dataElementService">
      <ref bean="org.hisp.dhis.dataelement.DataElementService" />
    </property>
    <property name="organisationUnitService">
      <ref bean="org.hisp.dhis.organisationunit.OrganisationUnitService" />
    </property>
    <property name="organisationUnitGroupService">
      <ref bean="org.hisp.dhis.organisationunit.OrganisationUnitGroupService" />
    </property>
    <property name="dataSetService">
      <ref bean="org.hisp.dhis.dataset.DataSetService" />
    </property>
    <property name="indicatorService">
      <ref bean="org.hisp.dhis.indicator.IndicatorService" />
    </property>
    <property name="dataDictionaryService">
      <ref bean="org.hisp.dhis.datadictionary.DataDictionaryService" />
    </property>
    <property name="categoryService">
      <ref bean="org.hisp.dhis.dataelement.DataElementCategoryService" />
    </property>
    <property name="localeManager">
      <ref bean="org.hisp.dhis.i18n.locale.LocaleManagerDb" />
    </property>
    <property name="name" value="I18nUpgrader" />
    <property name="runlevel" value="8" />
    <property name="skipInTests" value="true" />
  </bean>

  <bean class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
    <property name="targetObject" ref="org.hisp.dhis.system.startup.StartupRoutineExecutor" />
    <property name="targetMethod" value="addStartupRoutine" />
    <property name="arguments">
      <list>
        <ref local="org.hisp.dhis.i18n.I18nUpgrader" />
      </list>
    </property>
  </bean>

</beans>
