<script>
	jQuery(document).ready(	function(){
		validation( 'addReportExcelForm', function( form ){ 
			var request = new Request();
			request.setResponseTypeXML( 'datalement' );
			request.setCallbackSuccess( function( xmlObject ){
				var type = xmlObject.getAttribute( 'type' );	
				if ( type == 'error' )
					showErrorMessage( xmlObject.firstChild.nodeValue );
				else 
					form.submit();			
				} );	
			var params = "name=" + getFieldValue( 'name' );	
			request.sendAsPost(params);
			request.send( "validateAddReportExcel.action" );
		} );	
		
		
		jQuery("#group").autocomplete("getReportExcelGroups.action", {
            width: 260,
            formatItem:function (row){
                return row[0];
            },
            formatResult:function (row){
                return row[0];
            },
            selectFirst: true
		});	
	});	
</script>

<h3>$i18n.getString('reports') : $i18n.getString('add')</h3>

<form id="addReportExcelForm" method="POST" action="addReportExcel.action">
	<table>
		<tr>
			<td><label for="name">$i18n.getString('name')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td><input type="text" name="name" id="name" style="width:20em" class="{validate:{required:true,minlength:2,maxlength:160}}"/></td>
		</tr>
		<tr>
			<td><label>$i18n.getString('excel_template')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td>				
				<select name="excel" style="min-width:20em">
					#foreach($templateFileName in $mapTemplateFiles.keySet())		
						<option value="$encoder.htmlEncode( $templateFileName )">$encoder.htmlEncode( $templateFileName )</option>						
					#end						
				</select>	
			</td>
		</tr>
		<tr>
			<td><label>$i18n.getString('report_type')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td>
				<select name="reportType" style="min-width:20em">
					<option value='NORMAL'>$i18n.getString('NORMAL')</option>					
					<option value='CATEGORY'>$i18n.getString('CATEGORY')</option>					
					<option value='PERIOD_COLUMN_LISTING'>$i18n.getString('PERIOD_COLUMN_LISTING')</option>	
					<option value='ORGANIZATION_GROUP_LISTING'>$i18n.getString('ORGANIZATION_GROUP_LISTING')</option>									
				</select>
			</td>
		</tr>	
		<tr>		
			<td><label>$i18n.getString('group')</label></td>
			<td><input type="text" id="group" name="group" style="width:20em" class="{validate:{required:true,minlength:2,maxlength:160}}"/></td>
		<td>		
		<tr>
			<td><label>$i18n.getString('period_postion_row')</label></td>
			<td><input type="text" name="periodRow"   style="width:10em" class="{validate:{required:false,number:true}}"/></td>
		</tr>
		<tr>
			<td><label>$i18n.getString('period_postion_column')</label></td>
			<td><input type="text" name="periodCol" style="width:10em" class="{validate:{required:false,number:true}}"/></td>
		</tr>
		<tr>
			<td><label>$i18n.getString('organisation_position_row')</label></td>
			<td><input type="text" name="organisationRow" style="width:10em" class="{validate:{required:false,number:true}}"/></td>
		</tr>

		<tr>		
			<td><label>$i18n.getString('organisation_position_column')</label></td>
			<td><input type="text" name="organisationCol" style="width:10em" class="{validate:{required:false,number:true}}"/></td>
		<td>
		<tr>
			<td></td>
			<td>
				<input type="submit" value="$i18n.getString('ok')" style="width:150px"/>
				<input type="button" value="$i18n.getString('cancel')" onclick="window.location = 'listReportExcel.action'" style="width:150px"/>
			</td>			
		</tr>	
	</table>
</form>