<h2>$!encoder.htmlEncode($!excelItemGroup.name)</h2>
<table width="100%">
<tr>
<td>
	$i18n.getString( "filter_by_name" ): <input type="text" onkeyup="filterValues( this.value , 1)" style="width:300px"/>
</td>
<td align="right">	
	<input type="button" onclick="mode='add'; openAddExcelItem()" value="$i18n.getString('add')" style="width:100px"/>
	<input type="button" onclick="window.location='listAllExcelItemGroup.action'" value="$i18n.getString('cancel')" style="width:100px"/>
</td>
</tr>
</table>
<table width="100%">
	<tr>
		<th>$i18n.getString('name')</th>
		<th>$i18n.getString('sheetNo')</th>	
		<th>$i18n.getString('row')</th>		
		<th>$i18n.getString('column')</th>		
		<th>$i18n.getString('expression')</th>		
			
		<th width="70px">$i18n.getString('operations')</th>		
	</tr>
	<tbody id="list">
	#set( $mark = false )
	#foreach($excelItem in $excelItems)
		<tr #alternate( $mark )>
			<td>$encoder.htmlEncode( $excelItem.name )</td>
			<td>$excelItem.sheetNo</td>
			<td>$excelItem.row</td>
			<td>$excelItem.column</td>
			<td>$excelItem.expression</td>
			<td align="center">				
				<a href="javascript:deleteExcelItem('$excelItem.id');" title="$i18n.getString( 'remove' )"><img src="../images/delete.png" alt="$i18n.getString( 'remove' )"></a>
				<a href="javascript:mode='update'; openUpdateExcelItem( '$excelItem.id' );" title="$i18n.getString( 'edit' )"><img src="../images/edit.png" alt="$i18n.getString( 'edit' )"></a>
			</td>
		</tr>
		#if( $mark )
			#set( $mark = false )
		#else
			#set( $mark = true )
		#end
	#end
	</tbody>
</table>

<script type="text/javascript">
	var i18n_confirm_delete = '$encoder.jsEscape($i18n.getString( "confirm_delete" ) , "'")';	
	var mode = null;
</script>

<form name="excelItem" method="post">
<div id="divExcelitem" style="position:fixed;display:none;width:450px;z-index:10001;background-color: white;border: medium solid silver;height:200px;padding:20px;">
	<div id="close" style="position:absolute;top:2px;right:2px;cursor: pointer;color:red;" onclick="hideById('divExcelitem');deleteDivEffect();">[x]</div>
	<input type="hidden" id="reportId" name="reportId" value="$!reportExcel.id"/>
	<input type="hidden" value="" id="id" name="id"/>
	<table>
		<tr>
			<td><label>$i18n.getString('name')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td><input type="text" id="name" name="name" style="width:20em"/></td>
		</tr>		
		<tr>
			<td><label>$i18n.getString('expression')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td>
				<input type="text" id="expression" name="expression" style="width:20em"/>
				<input type="button" value="$i18n.getString('expression')" onclick="openExpressionBuild();"/>			
			</td>
			
		</tr>	
		<tr>
			<td><label>$i18n.getString('sheet_no')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td><input type="text" id="sheetNo" name="sheetNo"  style="width:10em"/></td>
		</tr>
		<tr>
			<td><label>$i18n.getString('row')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td><input type="text" id="row" name="row"  style="width:10em"/></td>
		</tr>
		<tr>
			<td><label>$i18n.getString('column')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td><input type="text" id="column" name="column" style="width:10em"/></td>
		</tr>			
	</table>
	<p align="center">
	<input type="button" value="$i18n.getString('ok')" id="reportItemButton" onclick="validateExcelItem();"/>
	<input type="button" value="$i18n.getString('cancel')" onclick="hideById('divExcelitem'); deleteDivEffect();"/>
	</p>
</div>
</form>

<!-- Expression -->

<div id="divExpression" style="position:fixed;display:none;width:800px;z-index:10002;background-color: white;border: medium solid silver;height:300px;padding:20px;">
	<div id="close" style="position:absolute;top:2px;right:2px;cursor: pointer;color:red;" onclick="$('#divExpression').hide();">[x]</div>
	<table width="100%">
		<tr>
			<th>$i18n.getString( "formula" )</th>
			<th></th>
			<th>$i18n.getString( "dataelement" )</th>
		<tr>
		<tr valign="top">
			<td>
				<textarea id="formula" cols="15" rows="11" style="width:250px; height:180px" wrap="virtual">$encoder.htmlEncode( $formula )</textarea><br>
				<a href="#" onclick="insertOperation( 'formula','(' )"><img src="images/left_parent.png" alt="$i18n.getString( 'left_brackets' )"></a>
				<a href="#" onclick="insertOperation( 'formula',')' )"><img src="images/right_parent.png" alt="$i18n.getString( 'right_brackets' )"></a>
				<a href="#" onclick="insertOperation( 'formula','*' )"><img src="images/multiply.png" alt="$i18n.getString( 'multiply' )"></a>
				<a href="#" onclick="insertOperation( 'formula','/' )"><img src="images/divide.png" alt="$i18n.getString( 'divide' )"></a>
				<a href="#" onclick="insertOperation( 'formula','+' )"><img src="images/plus.png" alt="$i18n.getString( 'plus' )"></a>
				<a href="#" onclick="insertOperation( 'formula','-' )"><img src="images/minus.png" alt="$i18n.getString( 'minus' )"></a>
			</td>
			<td valign="bottom">
				<input type="button" value="<" onclick="insertDataElementId()"/>
			</td>
			<td>	
				<select id="dataElementGroup" style="min-width:500px" onchange="getDataElementsByGroup()"></select>				
                <select name="select" size="11" id="availableDataElements" style="min-width:500px">
                </select>				
              <select id="optionCombos" size=4 style="min-width:500px"></select>	
			</td>
		</tr>	
	</table>	
	<p>
	<input type="button" value="$i18n.getString('ok')" onclick="$('#expression').val($('#formula').val());$('#divExpression').hide();"/>
	<input type="button" value="$i18n.getString('clean')" onclick="$('#formula').val('')"/></p>
</div>

<span id="message" style="top:100px;right:5px;position:fixed;width:200px;z-index:10004" onclick="hideById(this.id);"></span>
<span id="info" style="display:none;top:70px;right:5px;position:fixed;" onclick="hideById(this.id)"></span>

<script type="text/javascript">

	var dataElementGroups = new Object();
	#foreach( $dataElementGroup in $dataElementGroups )
		dataElementGroups['$dataElementGroup.id'] = '$encoder.jsEscape( $dataElementGroup.name, "'" )';
	#end

	
</script>
<div id="copyTo" style="position:fixed;display:none;width:450px;z-index:10001;background-color: white;border: medium solid silver;padding:20px;">
<div id="close" style="position:absolute;top:2px;right:2px;cursor: pointer;color:red;" onclick="hideById('copyTo'); deleteDivEffect();">[x]</div>
<table width="100%">
	<tr>
		<td>$i18n.getString('reports')</td>
		<td>
			<select id="targetGroup" style="max-width:30em;min-width:30em;">
			</select>
		</td>
	</tr>
	<tr>
		<td>$i18n.getString('sheet_no')</td>
		<td><input id="targetSheetNo" type="text"/></td>
	</tr>	
</table>
<p align="center">
<input type="button" value="$i18n.getString('ok')" onclick="saveCopyItems();"/>
<input type="button" value="$i18n.getString('cancel')" onclick="hideById('copyTo'); deleteDivEffect();"/>
</p>
</div>