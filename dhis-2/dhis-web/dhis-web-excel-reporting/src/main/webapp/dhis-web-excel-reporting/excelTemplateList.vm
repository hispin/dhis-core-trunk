<h2>$i18n.getString('excel_template_management')</h2>

<table>
<form name="uploadForm" id="uploadForm" action="uploadExcelTemplate.action" onsubmit="return validateUploadExcelTemplate(document.getElementById('upload').value, 1);" method="post" enctype="multipart/form-data">
	<tr>
		<td width="18%" style=" width:25% ">$i18n.getString( 'select_excel_file' ):</td>
		<td width="82%">
			<input type="file" id="upload" name="upload" onChange="enable('uploadButton');" />
			<input name="uploadButton" id="uploadButton" type="submit" value="$i18n.getString( 'upload_file' )" disabled />    
		</td>   
	</tr>
</form>
</table>
<table width=100%>
	<tr>
		<td>
			$i18n.getString( "filter_by_name" ): <input type="text" onkeyup="filterValues( this.value , 1)" style="width:300px"/>
		</td>
		<td>

		</td>
		<td align=right>
			<input type="button" onclick="mode='add'; openAddTemplateFile()" value="$i18n.getString('add')" style="width:100px"/>
			<input type="button" value="$i18n.getString( "cancel" )" onclick="window.location='administration.action'" style="width:100px"/>
		</td>
	</tr>
</table>

<table width="100%">
	<tr>
		<th>$i18n.getString('name')</th>
		<th width="110px">$i18n.getString('operations')</th>
	</tr>
	<tbody id="list">
	#set( $mark = false )
	#foreach($templateFile in $templateFiles)
		<tr #alternate( $mark )>
			<td>$encoder.htmlEncode( $templateFile.name )</td>
			<td align="left">
				<a href="javascript:deleteExcelTemplate('$templateFile.name');" title="$i18n.getString( 'remove' )"><img src="../images/delete.png" alt="$i18n.getString( 'remove' )"></a>
				<a href="javascript:mode = 'edit'; openEditExcelTemplate( '$templateFile.name' );" title="$i18n.getString( 'edit' )"><img src="../images/edit.png" alt="$i18n.getString( 'edit' )"></a>
			</td>
		</tr>
		#if( $mark )
			#set( $mark = false )
		#else
			#set( $mark = true )
		#end
	#end
	</tbody>
</table>

<div id="editExcelTemplateDiv" style="position:fixed;display:none;width:444px;z-index:11;background-color: white;border: medium solid silver;height:60px;padding:20px">
	<div id="close" style="position:absolute;top:2px;right:2px;cursor: pointer;color:red;" onclick="hideById('editExcelTemplateDiv');deleteDivEffect();hideMessage();">[x]</div>
	<input type="hidden" value="" id="id"/>
	<table>
		<tr>
			<td><label>$i18n.getString('name')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td><input type="text" id="name"  style="width:20em" name="T1" size="20" onkeyup="javascript: validateRenamingExcelTemplate(this.value ,1);"/></td>
			<td><input type="button" value="$i18n.getString('ok')" id="excelTemplateButtonRename" disabled="disabled" onClick="javascript: "/></td>
			<td><input type="button" value="$i18n.getString('cancel')" onclick="hideById('editExcelTemplateDiv');deleteDivEffect();hideMessage();"/></td>
		</tr>
	</table>
</div>
<span id="message" style="top:100px;right:5px;position:fixed;width:300px;z-index:10002" onclick="javascript:hideById(this.id);"></span>

<script language="javascript">

	var mode = 'add';
	var i18n_file_exists = '$encoder.jsEscape($i18n.getString( 'file_exists' ) , "'")';
	var i18n_confirm_delete = '$encoder.jsEscape($i18n.getString( 'confirm_delete' ) , "'")';
	var i18n_confirm_override = '$encoder.jsEscape($i18n.getString( 'confirm_override' ) , "'")';
	var i18n_filename_wellformed = '$encoder.jsEscape($i18n.getString( 'filename_wellformed' ) , "'")';
	var i18n_length_filename_min5_max30 = '$encoder.jsEscape($i18n.getString( 'length_filename_min5_max30' ) , "'")';
	var i18n_use_only_letters_numbers_dot_only = '$encoder.jsEscape($i18n.getString( 'use_only_letters_numbers_dot_only' ) , "'")';
	
	#if ( $message )
	
		$(document).ready( function() {
		
			setMessage( '<b>' + '$newFileUploaded' + '</b><br/>' + '$i18n.getString( "$message" )' );
		});
		
	#end

</script>