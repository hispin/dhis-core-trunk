<h2>$i18n.getString( "generate_report" )</h2>
<table >	
	<tr>
		<td ><label>$i18n.getString('group')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
		<td >
			<select type="text" id="group" name="group" style="min-width:20em" onchange="getReportExcelsByGroup()" #if(!$organisationUnit) disabled #end>
				#foreach($group in $groups)
					<option value='$group'>$encoder.htmlEncode( $group )</option>				
				#end
			</select>
		</td>
	    <td width="22%" rowspan="4" align="left" style="width:300px;vertical-align:top" >		
		</td>
	</tr>
	<tr>
		<td><label>$i18n.getString('reports')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
		<td>
			<select type="text" id="report" name="report" style="min-width:20em" #if(!$organisationUnit) disabled #end>
				#foreach($report in $reports)
					<option value='$report.id'>$encoder.htmlEncode( $report.name )</option>				
				#end
			</select>
		</td>
    </tr>
	<tr>
		<td></td>
		<td>
			<input type="button" value="<<" onclick="lastYear();" #if(!$organisationUnit) disabled #end/><input type="button" value=">>" #if(!$organisationUnit) disabled #end onclick="nextYear()"/>
		</td>
    </tr>
	<tr>
		<td><label>$i18n.getString('period')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
		<td>
			<select type="text" id="period" style="min-width:20em" #if(!$organisationUnit) disabled #end>
				#foreach($period in $periods)
					<option value='$period.id'>$format.formatPeriod( $period )</option>				
				#end
			</select>
		</td>
    </tr>
	<tr>
	  <td>&nbsp;</td>
	  <td><input type="checkbox" id="advancedCheck" name="advancedCheck" onChange="javascript : openGenerateAdvance();" />
$i18n.getString('generate_report_by_orgunit_group') </td>
	  <td align="left" style="width:300px;vertical-align:top" >&nbsp;</td>
  </tr>
	<tr>
	  <td>&nbsp;</td>
	  <td><div id="generateAdvance" style="display:block;width:300px; z-index:10001;background-color: white;">
          <select id="availableOrgunitGroups" name="availableOrgunitGroups" style="min-width:300px; "  disabled>
  </select>
</div>	</td>
	  <td align="left" style="width:300px;vertical-align:top" >&nbsp;</td>
  </tr>	
</table> 
<div id="actions" style="width:200px text-align:right">

</div>
<div id="orgUnitTree">
	
</div>


		  
<span id="message" style="top:100px;right:5px;position:fixed;width:200px;z-index:10002" onclick="hideById(this.id);"></span>
<br>
<hr>
<p>

<input type="button" value='$i18n.getString( "preview_report" )' onclick="javascript: generic_type = 'preview'; var message = '$!i18n.getString("please_wait")'; validateGenerateReport(message);" #if(!$organisationUnit) disabled #end/>
<input name="generate_report" id="generate_report"  type="button" onClick="generateReportExcel()" value='$i18n.getString( "generate_report" )' #if(!$organisationUnit) disabled #end/>
<input name="generate_advanced_report" id="generate_advanced_report" type="button" onClick="generateAdvancedReportExcel()" value='$i18n.getString( "fasd_generate_report" )' style="visibility:hidden " />

<input type="button" value='$i18n.getString( "preview_report" )' onclick="javascript: generic_type = 'preview'; validateGenerateReport('$!i18n.getString("please_wait")');" #if(!$organisationUnit) disabled #end/>
<input type="button" id="generate_report" value='$i18n.getString( "generate_report" )' onclick="generateReportExcel();" #if(!$organisationUnit) disabled #end/>


</p>
<span id="info" style="display:none;top:70px;right:5px;position:fixed;" onclick="hideById(this.id)">
	
</span>
<span id="loading" style="display:none;position:fixed;"><img src="../images/ajax-loader.gif" /></span>

<script>
#if($organisationUnit)
	getReportExcelsByGroup();
#end
</script>