<h3>$i18n.getString('excelitem_group') #openHelp( "excelReportingExcelItems" )</h3>
<table width=100%>
	<tr>
		<td>
			$i18n.getString( "filter_by_name" ): <input type="text" onkeyup="filterValues( this.value , 1)" style="width:300px"/>
		</td>
		<td align=right>
			<input type="button" onclick="mode='add'; openAddExcelItemGroup()" value="$i18n.getString('add')" style="width:100px"/>
			<input type="button" value="$i18n.getString( "cancel" )" onclick="window.location='administration.action'" style="width:100px">
		</td>
	</tr>
</table>

<table width="100%" class="listTable">
	<thead>
		<tr>
			<th>$i18n.getString('name')</th>
			<th>$i18n.getString('type')</th>
			<th>$i18n.getString('period_type')</th>		
			<th width="110px">$i18n.getString('operations')</th>		
		</tr>
	</thead>
	<tbody id="list">	
	#foreach($excelItemGroup in $excelItemGroups)
		<tr id="tr${excelItemGroup.id}">
			<td>$encoder.htmlEncode( $excelItemGroup.name )</td>
			<td>$i18n.getString($excelItemGroup.type)</td>
			<td>$encoder.htmlEncode( $excelItemGroup.periodType.name )</td>
			<td align="left">
				<a href="openExcelItemGroupAssociations.action?excelItemGroupId=$excelItemGroup.id" title="$i18n.getString( 'associations' )"><img src="../images/assign.png" alt="$i18n.getString( 'associations' )"></a>
				<a href="listExcelItems.action?excelItemGroupId=$excelItemGroup.id" title="$i18n.getString( 'excel_item' )"><img src="../images/add_section.png" alt="$i18n.getString( 'excelitem' )"></a>
				<a href="javascript:mode = 'edit'; openUpdateExcelItemGroup( '$excelItemGroup.id' );" title="$i18n.getString( 'edit' )"><img src="../images/edit.png" alt="$i18n.getString( 'edit' )"></a>
				<a href="javascript:translate( 'ExcelItemGroup', '$excelItemGroup.id' )" title="$i18n.getString( "translation_translate" )"><img src="../images/i18n.png" alt="$i18n.getString( "translation_translate" )"></a>
				<a href="javascript:removeItem($excelItemGroup.id, '$excelItemGroup.name','$i18n.getString( 'confirm_delete' )', 'deleteExcelItemGroup.action');" title="$i18n.getString( 'remove' )"><img src="../images/delete.png" alt="$i18n.getString( 'remove' )"></a>
				#if($excelItemGroup.isOrganisationUnitGroupListing())
				<a href="openUpdateOrgnisationUnitGroupForExcelItemGroup.action?id=$excelItemGroup.id" title="$i18n.getString( 'organisation_unit_group' )"><img src="images/group_1.jpg"/></a>
				#end
				#if($excelItemGroup.isCategory())				
				<a href="listDataElementGroupOrderForExcelItemGroup.action?id=$excelItemGroup.id" title="$i18n.getString( 'dataelement_groups' )"><img src="images/group.jpg"/></a>
				#end
			</td>
		</tr>	
		
	#end
	</tbody>
</table>

<div id="divExcelitemGroup" style="position:fixed;display:none;width:400px;z-index:11;background-color: white;border: medium solid silver;height:100px;padding:20px;">
	<div id="close" style="position:absolute;top:2px;right:2px;cursor: pointer;color:red;" onclick="hideById('divExcelitemGroup');deleteDivEffect();">[x]</div>
	<input type="hidden" value="" id="id"/>
	<table>
		<tr>
			<td><label>$i18n.getString('name')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td><input type="text" id="name"  style="width:20em"/></td>
		</tr>
		<tr>
			<td><label>$i18n.getString('report_type')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td>
				<select type="text" id="type" name="type" style="min-width:20em">
					<option value='NORMAL'>$i18n.getString('NORMAL')</option>					
					<option value='CATEGORY'>$i18n.getString('CATEGORY')</option>					
					<!-- <option value='PERIOD_COLUMN_LISTING'>$i18n.getString('PERIOD_COLUMN_LISTING')</option>	-->
					<option value='ORGANIZATION_GROUP_LISTING'>$i18n.getString('ORGANIZATION_GROUP_LISTING')</option>									
				</select>
			</td>
		</tr>	
		<tr>
			<td><label>$i18n.getString('periodType')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td>
				<select type="text" id="periodType" name="periodType" style="min-width:20em">
					#foreach ( $periodType in $periodTypes )
             		 <option value="$periodType.name" #if( $excelitemGroup.periodType.name.equals( $periodType.name ) ) selected="selected" #end>$i18n.getString( $periodType.name )</option>
            		#end						
				</select>
			</td>
		</tr>	
		
	</table>
	<p align="center">
	<input type="button" value="$i18n.getString('ok')" id="excelitemGroupAddUpdateButton" onClick="validateExcelItemGroup()"/>
	<input type="button" value="$i18n.getString('cancel')" onclick="hideById('divExcelitemGroup');deleteDivEffect();"/>
	</p>
</div>
<script language="javascript">
	var mode = 'add';	
</script>

<span id="message" style="top:100px;right:5px;position:fixed;width:200px;z-index:10002" onclick="javascript:hideById(this.id);"></span>




