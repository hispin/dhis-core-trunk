<span id='message'></span>
<h3>$i18n.getString( "dataset_completed_report" ) #openHelp( "excelReportingIndividualReport" )</h3>
<form id="dataSetCompletedReportForm" method="post" action="selectDataSetCompletedReport.action">

<table>
	<tr>
		<td><label>$i18n.getString('organisation')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
		<td width="25em"><input type="text" id="organisation" value="$!organisationUnit.name" disabled style="width:20em"></td>	
		<td>
			<label>$i18n.getString('view_by')</label>
			<select type="text" id="viewby" name="viewBy" style="min-width:20em" onchange="changeViewBy()" #if($disabled) disabled #end>
				<option value="period">$i18n.getString('period')</period>
				<option value="dataset">$i18n.getString('dataset')</period>
			</select>
		</td>			
	</tr>
	<tr>
		<td><label>$i18n.getString('period_type')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
		<td>
			<select type="text" id="periodType" name="periodType" style="min-width:20em" onchange="javascript: byId('dataSetCompletedReportForm').submit();" #if($disabled) disabled #end>
				<option value="">$i18n.getString('select_period_type')</option>
				#foreach($type in $periodTypes)
					<option value='$type.name' #if($type.name.equals($periodType)) selected #end>$i18n.getString( $type.name )</option>				
				#end
			</select>
		</td>
		
	</tr>
</table>
<hr>
<table>	
	<tr>
		<th>$i18n.getString('dataset')</th>
		<th></th>
		<th>$i18n.getString('selected_dataset')</th>
	</tr>	
	
	<tr>		
		<td>
			<select type="text" size=10 id="dataSet" #if($disabled) disabled #end name="dataSets" style="min-width:20em" ondblclick="moveSelectedById('dataSet','selectedDataSets')">
				#foreach($dataSet in $dataSets)
					<option value='$dataSet.id'>$i18n.getString( $dataSet.name )</option>				
				#end
			</select>
		</td>
		<td>
			<input type="button" value=" > " onclick="moveSelectedById('dataSet','selectedDataSets');" #if($disabled) disabled #end/><br>
			<input type="button" value=" < " onclick="moveSelectedById('selectedDataSets','dataSet');" #if($disabled) disabled #end/>
		</td>
		<td>
			<select type="text" size=10 id="selectedDataSets" #if($disabled) disabled #end name="selectedDataSets" style="min-width:20em" ondblclick="moveSelectedById('selectedDataSets','dataSet')">
			
			</select>
		</td>	
	</tr>
	
	<tr>
		<th>$i18n.getString('period')</th>
		<th></th>
		<th>$i18n.getString('selected_period')</th>
	</tr>	
	
	<tr>
		
		<td>
			<select type="text" id="period" #if($disabled) disabled #end name="periods" style="min-width:20em" size=10 ondblclick="moveSelectedById('period','selectedPeriods');">
				#foreach($period in $periods)
					<option value='$period.id'>$format.formatPeriod( $period )</option>				
				#end
			</select>
		</td>
		<td>
			<input type="button" value=" > " onclick="moveSelectedById('period','selectedPeriods');" #if($disabled) disabled #end/><br>
			<input type="button" value=" < " onclick="moveSelectedById('selectedPeriods','period');" #if($disabled) disabled #end/>
		</td>
		<td>
			<select type="text" id="selectedPeriods" name="selectedPeriods" style="min-width:20em" #if($disabled) disabled #end size=10 ondblclick="moveSelectedById('selectedPeriods','period');">
			
			</select>
		</td>
	</tr>
</table>

<hr>
<p><input id="viewButton" type="button" value="$i18n.getString('view')" onclick="viewDataSetCompleted();" #if($disabled) disabled #end/><p>
</form>
<script>
	
	function organisationUnitSelected( orgUnits )
	{	
		byId('dataSetCompletedReportForm').submit();
	}
	
	function organisationUnitSelectedCompleted(xmlObject){
		if(xmlObject.getAttribute('null')=='true'){	
			disable('viewButton');
		}else{
			enable('viewButton');
			setFieldValue('organisation',getElementValue(xmlObject, 'name'));
		}
			
	}

	selection.setListenerFunction( organisationUnitSelected );
	
	changeViewBy();
</script>