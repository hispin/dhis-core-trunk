<script>
	jQuery(document).ready(function(){	
		validation( 'reportItem', function( form ){ 			
			validateUpdateReportExcelItem( form );
		});
	});
	
	var category = $reportExcel.isCategory();
	
</script>

<h3>$i18n.getString( 'update_report_excel_item' )</h3>
<br>
<form id="reportItem" name="reportItem" method="post" action="updateReportExcelItem.action">
	<input type="hidden" id="reportId" name="reportId" value="$reportExcel.id"/>
	<input type="hidden" id="id" name="id" value="$reportExcelItem.id"/>
	<input type="hidden" id="currentExpression" name="currentExpression" value="$reportExcelItem.expression"/>
	<table>
		<tr>
			<th colspan="2">$i18n.getString( 'report_excel' )</th>
		</tr>
		<tr>
			<td><label>$i18n.getString('name')</label></td>
			<td>: $!encoder.htmlEncode($!reportExcel.name)</td>
		</tr>
		<tr>
			<td><label>$i18n.getString('report_type')</label></td>
			<td>: $i18n.getString( $!reportExcel.getReportType() )</td>
		</tr>
		<tr>
			<td colspan="2" height="20px"></td>
		</tr>
		<tr>
			<th colspan="2">$i18n.getString( 'report_excel_item' )</th>
		</tr>
		<tr>
			<td><label>$i18n.getString('name')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td><input type="text" id="name" name="name" value="$!encoder.htmlEncode($reportExcelItem.name)" style="width:20em" class="{validate:{required:true}}"/></td>
		</tr>		
		<tr>
			<td><label>$i18n.getString('item_type')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td>
				<select type="text" id="itemType" name="itemType" style="min-width:20em" onchange="changeItemType()">					
					#foreach( $type in $reportExcel.getItemTypes() )
					<option value='$type' #if($type==$reportExcelItem.getItemType()) selected="selected" #end >$i18n.getString( $type )</option>	
					#end	
				</select>
			</td>
		</tr>
		<tr>
			<td><label>$i18n.getString('period_type')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td>
				<select type="text" id="periodType" name="periodType" style="min-width:20em">
					#foreach( $type in $periodTypes )
						<option value='$type' #if($type==$reportExcelItem.getPeriodType()) selected="selected" #end>$i18n.getString( $type )</option>	
					#end				
				</select>
			</td>
		</tr>
		<tr>
			<td><label>$i18n.getString('expression')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td>				
				<input type="button" id="expression-button" value="$i18n.getString('expression')" style="width:20em"/>											
				<input type="hidden" id="expression" name="expression" value="$reportExcelItem.expression" style="width:15em" class="{validate:{required:true}}"/>				
			</td>
			
		</tr>	
		<tr>
			<td><label>$i18n.getString('sheet_no')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td><input type="text" id="sheetNo" name="sheetNo" value="$reportExcelItem.sheetNo"  style="width:20em" class="{validate:{required:true,number:true}}"/></td>
		</tr>
		<tr>
			<td><label>$i18n.getString('row')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td><input type="text" id="row" name="row" value="$reportExcelItem.row"  style="width:20em" class="{validate:{required:true,number:true}}"/></td>
		</tr>
		<tr>
			<td><label>$i18n.getString('column')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
			<td><input type="text" id="column" name="column" value="$reportExcelItem.column" style="width:20em" class="{validate:{required:true,number:true}}"/></td>
		</tr>
		<tr>
			<td height="20px"></td>
			<td></td>
		</tr>	
		<tr>
			<td></td>
			<td>
				<input type="submit" value="$i18n.getString('ok')" id="reportItemButton" style="width:100px"/>
				<input type="button" value="$i18n.getString('cancel')" onclick="window.location='listReportExcelItemAction.action?reportId=$reportExcel.id'" style="width:100px"/>
			</td>
		</tr>
		
	</table>
</form>

<!-- EXPRESSION FORM -->

#parse( "/dhis-web-excel-reporting/report/dataelementExpressionBuilderForm.vm" )

#parse( "/dhis-web-excel-reporting/report/indicatorExpressionBuilderForm.vm" )

#parse( "/dhis-web-excel-reporting/report/excelFormulaExpressionBuilderForm.vm" )


