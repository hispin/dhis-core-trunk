<hr>
<!-- IDENTIFIERS -->
#if( $identifierTypes.size() > 0)
	<h3>$i18n.getString('patient_identifier_and_attributes') <img src='../images/down.png' onclick='toogleDiv( "enrollmentInforDiv" );'></h3>
	<table class='mainPageTable' id='enrollmentInforDiv' name='enrollmentInforDiv' >
		<col id="stageCol">    
		<col id="entryCol">    
		<tr>
			<th>$i18n.getString( "patient_identifier" )</th>                   
			<th>$i18n.getString( "value" )</th>        
		</tr>
		
		#set( $tabIndex = 1 )
		#set( $mark = false )
		#foreach ($identifierType in $identifierTypes)
			#set( $identifier = $identiferMap.get( $identifierType.id ) )
			<tr #alternate( $mark )>
				<td class='text-column'><label>$identifierType.name #if($identifierType.mandatory == true )<em title="$i18n.getString( 'required' )" class="required">*</em> #end</label></td>       
					<td class="input-column">
					<input type="text" id="iden$identifierType.id" name="iden$identifierType.id" value='$identifier' class="{validate:{required:$identifierType.mandatory, #if($!identifierType.noChars) maxlength:$identifierType.noChars, #end #if($identifierType.type=='number') number:true #elseif($!identifierType.type=='letter') lettersonly:true #end }}" onchange='savePatientIdentifier( $identifierType.id, this);' onkeypress="return keyPress(event, this)" onkeypress="return keyPress(event, this)" tabindex="$tabIndex" /></td>
			</tr>
		#set( $tabIndex = $tabIndex + 1 )
		#set( $mark = !$mark  )
		#end
	</table>
#end

<!-- Program-stage-instance list -->

#if( $programStageInstances.size() > 0 )
<h3>$i18n.getString('program_stage') <img src='../images/down.png' onclick='toogleDiv( "progarmStageListDiv" );'></h3>
	<table class='mainPageTable hidden' id='progarmStageListDiv' name='progarmStageListDiv' >
		<col id="noCol">
		<col id="stageCol">    
		<col id="entryCol">    
		<tr>
			<th>$i18n.getString( "nr" )</th>
			<th>$i18n.getString( "program_stage" )</th>                   
			<th>$i18n.getString( "due_date" )</th>        
		</tr>
		
	#set( $rowCount = 0 )
	#set( $mark = false )
	#set( $tabIndex = 1 )
	
	#foreach( $programStageInstance in $programStageInstances )
	
		#set( $rowCount = $rowCount + 1 )   
		<tr #alternate( $mark ) >
			##rowCount
			<td>$rowCount</td>        
			##stage name
			<td class='textColumn'>
				<span id="value[$programStageInstance.id].name" title="$!encoder.htmlEncode( $programStageInstance.programStage.description )">
					$encoder.htmlEncode( $programStageInstance.programStage.name )            
				</span>
			</td>        
				   
			##entry
			#set( $duedateId = "value_"+$programStageInstance.id+"_date" )        
			<td class='input-column '>        
				<input type="text" id="$duedateId" name="entryfield" value="$!format.formatDate( $programStageInstance.dueDate )" onchange="saveDueDate( $programStageInstance.id, '$encoder.jsEncode( $programStageInstance.programStage.name )' )" tabindex="$tabIndex" >
				<script type="text/javascript">
					datePicker( '$duedateId' );
				</script> 
			</td>      
		</tr>
		#set( $tabIndex = $tabIndex + 1 )
		#set( $mark = !$mark  )
	#end
	</table>
#end


<script type="text/javascript">
	byId('enrollBtn').value = i18n_update;
	setInnerHTML('enrollmentDateDescription', "$!program.dateOfEnrollmentDescription" );
	setInnerHTML('dateOfIncidentDescription', "$!program.dateOfIncidentDescription" );
	setFieldValue('enrollmentDate', "$!format.formatDate( $programInstance.enrollmentDate )" );
	setFieldValue('dateOfIncident', "$!format.formatDate( $programInstance.dateOfIncident )");
	
	if ( getFieldValue('enrollmentDate' ) == ''){	
		jQuery('#enrollBtn').attr( 'value',i18n_enroll_to_program );
	}else{
		jQuery('#enrollBtn').attr( 'value',i18n_update );
	}	
</script>

