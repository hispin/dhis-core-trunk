<script src="javascript/tooltip.js" type="text/javascript"></script>
<table>
	<tr>
		<td class='text-column' >$i18n.getString( "search_result_matching_the_search_criteria" ):</td>
		<td>&nbsp;</td>
		<td>&nbsp;</td>
		<td id='searchInforLbl'>
		#if($!listAll)
			$i18n.getString( "list_events" )
		#else
			$i18n.getString( "search_patients" )
		#end
		</td>
	</tr>	
	
	<tr>
		<td class='text-column'>$i18n.getString( "total_result" ):</td>
		<td>&nbsp;</td>
		<td>&nbsp;</td>
		<td id='totalTd'>$!total</td>
	</tr>
</table>

#if( $programStageInstances && $programStageInstances.size()>0 )

<table class='listTable gridTable'>
	<col/>
	<col/>
	<col width='30%'/>
	<thead>
		<tr>
			<th>$i18n.getString('risk')</th>
			<th>$i18n.getString('full_name')</th>
			<th>$i18n.getString('phone_number')</th>
			<th>$i18n.getString( "events" )</th>
			<th>$i18n.getString( "operations" )</th>
		</tr>
	</thead>
	<tbody id="list">
	#set($patientId='')
	#set($count=1)
	#set($class='listRow')
	#set($alterclass='listAlternateRow')
	#foreach( $programStageInstance in $programStageInstances )
		#set($patient = $programStageInstance.programInstance.patient)
		<tr>
			#if( $patientId != $patient.id )
			<td name="infor_$patient.id" class='$class'>
				#set( $comment = $!programStageInstance.programInstance.patientComment.commentText )
				#if( $$!programStageInstance.programInstance.followup == 'true') 
				<img src='../images/marked.png' alt='$comment'>
				#else
				<img src='../images/unmarked.png'>			
				#end
			</td>
			
			<td name='infor_$patient.id' class='$class'><a href="javascript:isDashboard=false;showPatientDashboardForm( '$patient.id' )">
				#set($value="")
				#foreach( $identifierType in $identifierTypes)
					#foreach( $identifier in $patient.identifiers)
						#if($identifier.identifierType.id==$identifierType.id)
							#set($value=$identifier.identifier)
						#end
					#end
				#end
				#if($value=="")
					#set($value=$patient.getFullName())
				#end
				
				$value
			</a></td>
			
			<td name='infor_$patient.id' class='$class'>$!patient.phoneNumber</td>
				#set($rowspan=1)
				#if($class=='listRow')
					#set($class='listAlternateRow')
					#set($alterclass='listRow')
				#else
					#set($class='listRow')
					#set($alterclass='listAlternateRow')
				#end
			#else
				#set($rowspan=$rowspan+1)
				<script>
					jQuery("[name=infor_" + "$patient.id]").attr('rowspan',$rowspan)
				</script>
			#end
			
			<td class='$alterclass'>
				<a href="javascript:programTrackingList( $programStageInstance.id, false );">
					$programStageInstance.programStage.displayName
					(#if($!programStageInstance.executionDate)
						$format.formatDate($!programStageInstance.executionDate)
					#else
						$format.formatDate($!programStageInstance.dueDate)
					#end)
				</a>
			</td>
			
			#if( $patientId != $patient.id ) 
			<td class='$alterclass' name='opt_$patient.id'>
				<a href="javascript:isDashboard=false;showPatientDashboardForm( '$patient.id' )" title="$i18n.getString( 'patient_dashboard' )"><img src="../images/enroll.png" alt='$i18n.getString( "patient_dashboard" )'></a>
				<a href="javascript:showPatientHistory('$patient.id')" title='$i18n.getString( "patient_details_and_history" )'><img src="../images/information.png" alt='$i18n.getString( "patient_details_and_history" )'></a>
			</td>
			#else
				<script>
					jQuery("[name=opt_" + "$patient.id]").attr('rowspan',$rowspan)
				</script>
			#end
			
			#set( $patientId = $patient.id )
		</tr>
	#end
	</tbody>
</table>

<div class="paging-container">
	#parse( "/dhis-web-commons/paging/paging.vm" )
</div>

<div id="detailsInfo"></div>

#end
