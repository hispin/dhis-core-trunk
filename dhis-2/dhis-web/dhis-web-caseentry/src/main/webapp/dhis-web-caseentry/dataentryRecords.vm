#parse( "/dhis-web-caseentry/multiDataEntrySelect.vm" )

<table class="mainPageTable">
    <tr>
        <td style="vertical-align:top">    
        <table class="listTable">
            <col>
			#if( $sortPatientAttributeId )
				<col>
			#end
            #foreach( $programStage in $program.programStages )
                <col>
            #end       
            <tr>
				#if( $sortPatientAttributeId )
					<th style="text-align:center">$encoder.htmlEncode( $sortingAttribute.name )</th>
				#end
                <th style="text-align:center">$i18n.getString( "full_name" )</th>
                #foreach( $programStage in $program.programStages )
                    <th style="text-align:center">$encoder.htmlEncode( $programStage.name )</th>
                #end                
            </tr>
          
            <tbody id="list">
                #set( $mark = false )                 
                #foreach( $patient in $patientListByOrgUnit )
					#set( $programInstance = $programInstanceMap.get( $patient ) )
                    <tr #alternate( $mark )>
						#if( $sortPatientAttributeId )
							#set( $patientAttributeValue = $patinetAttributeValueMap.get( $patient ) )
							<td>$!patientAttributeValue.value</td>
						#end
                        <td><a href="javascript:showPatientDetails( $programInstance.patient.id )" title="$i18n.getString( "show_details" )">$patient.getFullName()</a></td>                    
                        #foreach( $programStageInstance in $programStageInstanceMap.get( $programInstance ) )
                            #if( $programStageInstance.executionDate )
                                <td style="text-align:center" bgcolor="$colorMap.get( $programStageInstance.id )">
                                    <a href="javascript:viewPrgramStageRecords( $programStageInstance.id );">$format.formatDate( $programStageInstance.executionDate )</a>
                                </td>
                            #else
                                <td style="text-align:center" bgcolor="$colorMap.get( $programStageInstance.id )">
									<a href="javascript:viewPrgramStageRecords( $programStageInstance.id );">$format.formatDate( $programStageInstance.dueDate )</a>
								</td>
                            #end
                        #end
                    </tr>
                    #if( $mark )
                        #set( $mark = false )
                    #else
                        #set( $mark = true )
                    #end 
                #end    
            </tbody>
        </table>
        </td>
    </tr>
</table>

<div class="paging-container">
	#parse( "/dhis-web-commons/paging/paging.vm" )
</div>


<div id="detailsArea" style="display:none;overflow:auto;height:250px;width:250px">
	<div style="float:right">
		<a href="javascript:hideDetails()" title="$i18n.getString( "hide_details" )"><img src="../images/close.png" alt="$i18n.getString( "hide_details" )"></a>
	</div>
	<p><label>$i18n.getString( "common_info" ):</label><br><span id="commonInfoField"></span></p>	
	<p><label>$i18n.getString( "identifier" ):</label><br><span id="identifierField"></span></p>
	<p><label>$i18n.getString( "attributes" ):</label><br><span id="attributeField"></span></p>
	<p><label>$i18n.getString( "enrolled_in_program" ):</label><br><span id="programField"></span></p>
</div>

<script>
	var i18n_id = '$encoder.jsEscape( $i18n.getString( "id" ), "'")';
	var i18n_full_name = '$encoder.jsEscape( $i18n.getString( "full_name" ), "'")';
	var i18n_gender = '$encoder.jsEscape( $i18n.getString( "gender" ), "'")';
	var i18n_dob_type = '$encoder.jsEscape( $i18n.getString( "dob_type" ), "'")';
	var i18n_date_of_birth = '$encoder.jsEscape( $i18n.getString( "date_of_birth" ), "'")';
	var i18n_blood_group = '$encoder.jsEscape( $i18n.getString( "blood_group" ), "'")';
	var i18n_none = '$encoder.jsEscape( $i18n.getString( "none" ), "'")';
</script>
