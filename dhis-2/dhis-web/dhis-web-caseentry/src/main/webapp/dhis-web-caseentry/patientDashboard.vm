<h4>
 <a href="javascript:onClickBackBtn();">$i18n.getString( 'back_to_registration' )</a>
 &#8226; <a href="javascript:showProgramEnrollmentForm( '$patient.id' )">$i18n.getString( "program_management" )</a>
 &#8226; <a href="javascript:showUpdatePatientForm( '$patient.id', true )">$i18n.getString( "edit_profile" )</a>
 &#8226; <a href="javascript:setFieldValue( 'isShowPatientList', 'false' ); showRelationshipList( '$patient.id' );">$i18n.getString( "manage_relationship" )</a>
 &#8226; <a href="javascript:getPatientLocation( '$patient.id' );">$i18n.getString( "change_patient_location" )</a>
</h4>

<table>
	<tr>
		<td valign='top'>
			<table>
				<tr>
					<td>
						<div class="link-area">
							<table width='100%'>
								<tr><th>$i18n.getString("demographics")</th></tr>
							</table>
							<div class="contentProviderTable">
								<table width='100%'>
									<tr>
										<td>$i18n.getString("full_name")</td>
										<td>$!patient.getFullName()</td>
									</tr>
									<tr>
										<td>$i18n.getString("gender")</td>
										<td>$i18n.getString($!patient.gender)</td>
									</tr>
									<tr>
										<td>$i18n.getString("date_of_birth")</td>
										<td>$format.formatDate( $!patient.birthDate) $!patient.getAge()</td>
									</tr>
									<tr>
										<td>$i18n.getString("phone_number")</td>
										<td>
											#if($!patient.phoneNumber && $!patient.phoneNumber!='')
												$!patient.phoneNumber
											#else
												[$i18n.getString('none')]
											#end
										</td>
									</tr>
									<tr>
										<td>$i18n.getString("health_worker")</td>
										<td>
											#if($!patient.healthWorker )
												$!patient.healthWorker.name
											#else
												[$i18n.getString('none')]
											#end
										</td>
									</tr>
									#foreach( $identifier in $identifiers )
									<tr>
										#if($!identifier.identifierType)
											<td>$identifier.identifierType.name</td>
										#else
											<td>$i18n.getString("system_identifier")</td>
										#end
										<td>$identifier.identifier</td>
									</tr>
									#end
									#foreach( $attributeValue in $attributeValues )
									<tr>
										<td>$attributeValue.patientAttribute.name</td>
										<td>$attributeValue.value</td>
									</tr>
									#end
								</table>
							</div>
						</div>
					</td>
					<td>
						<div class="link-area" style='height:190px;'>
							<table width='100%'>
								<tr><th>
										$i18n.getString("active_programs")
										<input type='button' value='$i18n.getString("enroll_program")' onclick='showProgramEnrollmentForm( "$patient.id" )'/>
									</th>
								</tr>
							</table>
							<div class="contentProviderTable" style='height:140px;'>
								<table width='100%' id='activeTB'>
									#foreach( $programInstance in $activeProgramInstances )
										#set($programStageInstanceId = '')
										#if($programInstance.program.type==2)
											#foreach( $programStageInstance in $programInstance.programStageInstances)
												#set($programStageInstanceId = $programStageInstance.id)
											#end
										#end
										
										#set($flag = 'false')
										#foreach( $programStageInstance in $programInstance.programStageInstances )
											#set( $status = $statusMap.get( $programStageInstance.id ) )
											#if( $status!=1 && $flag=='false')
												<tr id='tr1_$programInstance.id' type='$programInstance.program.type'
													programStageInstanceId='$programStageInstanceId'>
													<td id='td_$programInstance.id'>
														<a href='javascript:loadActiveProgramStageRecords("$programInstance.id", "$programStageInstance.id")'><span id='infor_$programInstance.id'>$programInstance.program.name ($format.formatDate($programInstance.enrollmentDate))</span></a>
													</td>
												</tr>
												<tr id='tr2_$programInstance.id' onclick='javascript:loadActiveProgramStageRecords("$programInstance.id", "$programStageInstance.id")' style='cursor:pointer;'>
													<td>
														<a>&#8226; $programStageInstance.programStage.name ($format.formatDate($programStageInstance.dueDate))</a>
													</td>
												</tr>
											#set($flag = 'true')
											#end
										#end
										#if($flag=='false')
										<tr id='tr1_$programInstance.id' type='$programInstance.program.type'
											programStageInstanceId='$programStageInstanceId'>
											<td id='td_$programInstance.id'>
												<a href='javascript:loadProgramInstance($programInstance.id, false)'>$programInstance.program.name ($format.formatDate($programInstance.enrollmentDate))</a>
											</td>
										</tr>
										#end
									#end
								</table>
							</div>
						</div>
						
						<div class="link-area" style='height:60px;'>
							<table width='100%'>
								<tr><th>$i18n.getString("completed_programs")</th></tr>
								<tr>
									<td>
										<select id="completedList" name="completedList" onchange="javascript:loadProgramInstance(this.value, true);" style="width:100%">
											#foreach($programInstance in $completedProgramInstances)
												#set($programStageInstanceId = '')
												#if($programInstance.program.type==2)
													#foreach( $programStageInstance in $programInstance.programStageInstances)
														#set($programStageInstanceId = $programStageInstance.id)
													#end
												#end
												<option value="$programInstance.id" type='$programInstance.program.type'>$programInstance.program.name ($format.formatDate($programInstance.enrollmentDate))</option>
											#end
										</select>
									</td>
								</tr>
							</table>
						</div>
					</td>
					<td>
						<div class="link-area">
							<table width='100%'>
								<tr><th>$i18n.getString("relationships")</th></tr>
							</table>
							<div class="contentProviderTable">
								<table width='100%'>
									#foreach( $rel in $relationship )
										#if($rel.patientA.id==$patient.id)
											<tr onclick="showPatientDashboardForm($rel.patientB.id)" title='$i18n.getString( "move_to_dashboard_of" ) $rel.patientB.getFullName()'>
												<td><a href='#'>$rel.relationshipType.bIsToA</a></td>
												<td><a href='#'>$rel.patientB.getFullName()</a></td>
											</tr>
										#else
											<tr onclick="showPatientDashboardForm($rel.patientA.id)" title='$i18n.getString( "move_to_dashboard_of" ) $rel.patientB.getFullName()'>
												<td><a href='#'>$rel.relationshipType.aIsToB</a></td>
												<td><a href='#'>$rel.patientA.getFullName()</a></td>
											</tr>
										#end
									#end
								</table>
							</div>
						</div>
					</td>
				</tr>
			</table>
		</td>
	</tr>
</table>

<div id='programEnrollmentDiv' class='hidden'></div>
<div id='dataEntryFormDiv'></div>