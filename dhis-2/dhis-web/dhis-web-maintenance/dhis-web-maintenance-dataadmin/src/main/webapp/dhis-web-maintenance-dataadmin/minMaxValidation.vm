<script>

//-----------------------------------------------------------------------
//init jQuery validation for reportAssociation
//-----------------------------------------------------------------------
	jQuery(document).ready(
			function()
			{
				jQuery("#minMaxGeneratingForm").validate({
					 meta:"validate"
					,errorElement:"td"
					,beforeValidateHandler : function()
											{
												
											}
					,submitHandler: function(form)
									{
										validateDataSet();
									}
				});
				jQuery.validator.loadLocaled( jQuery("#curLocaleCode").val() );
			}
	);

</script>
<input type="hidden" id="curLocaleCode" value="$locale.getLanguage()_$locale.getCountry()"/>
<h3>$i18n.getString( "min_max_validation" )</h3>
<form id="minMaxGeneratingForm" action="getMinMaxValidationParams.action" method="POST">
<table>
  <tr>
    <th colspan="2">$i18n.getString('available_dataset')</th>
    <td>&nbsp;</td>
    <th>$i18n.getString('organisation_unit')</th>
  </tr>
  <tr>
    <td>$i18n.getString('start_date')<em title="$i18n.getString( "required" )" class="required">*</em></td>
    <td><input type="text" id="startDateStr" name="startDateStr" style="width:15em" class="{validate:{required:true,dateISO:true}}">
		<img src="../images/calendar_icon.gif" width="16" height="16" id="getStartDate" style="cursor: pointer;" title="$i18n.getString("date_selector")" onmouseover="this.style.background='orange';" onmouseout="this.style.background=''" alt="$i18n.getString( "start_date" )">
		<script type="text/javascript">
        Calendar.setup({
            inputField     :    "startDateStr",      // id of the input field
            ifFormat       :    "$i18n.getString("format.date.label")",       // format of the input field
            button         :    "getStartDate"   // trigger for the calendar (button ID)
        });
  	</script>
	</td>
    <td style="width:10px ">&nbsp;</td>
    <td><input type="button" value="$i18n.getString( "select_all_at_level_min_max" )" onclick="selectAllAtLevel()" style="width:12em">
		<select id="levelList" name="levelList" style="width:12em">
			#foreach( $lev in $levels )
				<option value="$lev.level" #if ( $level == $lev.level )selected="selected"#end>$encoder.htmlEncode( $lev.name )</option>
			#end
		</select>
		<input type="button" value="$i18n.getString( "unselect_all_at_level_min_max" )" onclick="unselectAllAtLevel()" style="width:12em">
		<input type="button" value="$i18n.getString( "unselect_all_min_max" )" onclick="unselectAll()" style="width:12em">        
	  </td>
  </tr>
  <tr>
    <td>$i18n.getString('end_date')<em title="$i18n.getString( "required" )" class="required">*</em></td>
    <td><input type="text" id="endDateStr" name="endDateStr" style="width:15em" class="{validate:{required:true,dateISO:true}}">
	    <img src="../images/calendar_icon.gif" width="16" height="16" id="getEndDate" style="cursor: pointer;" title="$i18n.getString("date_selector")" onmouseover="this.style.background='orange';" onmouseout="this.style.background=''" alt="$i18n.getString( "end_date" )">
		<script type="text/javascript">
        Calendar.setup({
            inputField     :    "endDateStr",      // id of the input field
            ifFormat       :    "$i18n.getString("format.date.label")",       // format of the input field
            button         :    "getEndDate"   // trigger for the calendar (button ID)
        });
  	</script>
	</td>
    <td style="width:10px ">&nbsp;</td>
    <td><input type="button" value="$i18n.getString( "select_all_in_group" )" onclick="selectGroup()" style="width:12em">
	  	<select id="groupList" name="groupList" style="width:12em">
	  		#foreach ( $group in $orgunitGroups )
	  			<option value="$group.id">$encoder.htmlEncode( $group.name )</option>
		  	#end
	  	</select>
	  	<input type="button" value="$i18n.getString( "unselect_all_in_group" )" onclick="unselectGroup()" style="width:12em">
  	  </td>
  </tr>
  <tr>
    <td colspan="2"><select size="26px" multiple style="width:30em" id='dataSetIds' name='dataSetIds'>   
	#foreach( $dataSet in $dataSets )
      <option value="$dataSet.id">$encoder.htmlEncode( $dataSet.name )</option>
	#end
    </select></td>
    <td style="width:10px ">&nbsp;</td>
    <td>
<div id="selectionTree" style="width:50em;height:30em;overflow:auto;border:1px solid #cccccc"></div>
 
</td>
  </tr>
  <tr>
    <td colspan="4" align="center">
      <input type="submit" id="submitButton" style="width:10em" value="$i18n.getString( 'save' )">
	  <input type="button"" style="width:10em" onClick="window.location.href='listReportExcel.action'" value="$i18n.getString( 'cancel' )"></td>
    </tr>
</table>
</form>
<span id='message' style='display: block'>$!message</span>
<script type="text/javascript">

	var i18n_loading = '$encoder.jsEncode( $i18n.getString( "loading" ) )';
	var levelMustBeInt = '$encoder.jsEncode( $i18n.getString( "level_must_be_int" ) )';
	var i18n_not_choose_dataset = '$encoder.jsEncode( $i18n.getString( "not_choose_dataset" ) )';
	var i18n_not_choose_organisation = '$encoder.jsEncode( $i18n.getString( "not_choose_organisation" ) )';
	var numberOfSelects = 0;
  
    selectionTreeSelection.setMultipleSelectionAllowed( true );
    selectionTreeSelection.setOnSelectFunction( treeClicked );
    selectionTreeSelection.setListenerFunction( selectCompleted );
    selectionTree.buildSelectionTree();

</script>
<span id="info" style="display:none;top:70px;right:5px;position:fixed;" onclick="hideById(this.id)"></span>