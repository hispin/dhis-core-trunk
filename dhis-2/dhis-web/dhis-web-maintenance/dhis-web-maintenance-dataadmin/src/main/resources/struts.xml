<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
"http://struts.apache.org/dtds/struts-2.0.dtd">
<struts>

  <include file="dhis-web-commons.xml"/>
  	
  <package name="dhis-web-maintenance-dataadmin" extends="dhis-web-commons" namespace="/dhis-web-maintenance-dataadmin">
	
    <action name="index" class="org.hisp.dhis.commons.action.NoAction">
      <result name="success" type="redirect">displayLockingForm.action</result>
    </action>
    
    <!-- Locking -->
	  
	<action name="emptyOrgunitSetupAssociationsTree"
      class="org.hisp.dhis.commons.action.NoAction">
      <result name="success" type="velocity">
        /dhis-web-maintenance-dataadmin/noResponseInFrame.vm</result>
      <param name="javascripts">
        javascript/oust.js,javascript/associations.js,javascript/locking.js</param>
    </action>
    
    <action name="displayLockingForm"
      class="org.hisp.dhis.dataadmin.action.lock.GetNumberOfLevelsAction">
      <result name="success" type="chain">defineDataSetAssociationsFormChain</result>      
    </action>
    
    <action name="defineDataSetAssociationsFormChain"
      class="org.hisp.dhis.dataadmin.action.lock.GetPeriodTypesAction">
      <result name="success" type="velocity">/main.vm</result>
      <param name="page">
        /dhis-web-maintenance-dataadmin/lockingForm.vm</param>
      <param name="menu">/dhis-web-maintenance-dataadmin/menu.vm</param>
      <param name="javascripts">
        javascript/oust.js,javascript/associations.js,javascript/locking.js</param>
    </action>
    
    <action name="getDataSetsForOrguntwiseLocking" class="org.hisp.dhis.dataadmin.action.lock.GetDataSetsForLockAction">
      <result name="success" type="velocity-xml">/dhis-web-maintenance-dataadmin/responseDataSet.vm</result>
      <param name="onExceptionReturn">plainTextError</param>
    </action>
    
    <action name="orgunitWiseSetupAssociationsTree"
      class="org.hisp.dhis.dataadmin.action.lock.SetupAssociationsTreeAction">
      <result name="success" type="velocity">
        /dhis-web-maintenance-dataadmin/selectionedTreeInFrame.vm</result>
      <param name="javascripts">
        javascript/oust.js,javascript/associations.js,javascript/locking.js</param>
    </action>
    
    <action name="defineLockOnDataSetOrgunitAndPeriod"
        class="org.hisp.dhis.dataadmin.action.lock.DefineLockOnDataSetOrgunitAndPeriod">
      <result name="success" type="redirect">displayLockingForm.action</result>
    </action>
 
	<action name="selectLevel"
      class="org.hisp.dhis.dataadmin.action.lock.SelectLevelAction">
      <result name="success" type="chain">getSelectionTree</result>
    </action>
    
    <action name="unselectLevel"
      class="org.hisp.dhis.dataadmin.action.lock.UnselectLevelAction">
      <result name="success" type="chain">getSelectionTree</result>
    </action>
    
    <action name="selectAll"
      class="org.hisp.dhis.dataadmin.action.lock.SelectAllAction">
      <result name="success" type="chain">getSelectionTree</result>
    </action>
    
    <action name="unselectAll"
      class="org.hisp.dhis.dataadmin.action.lock.UnselectAllAction">
      <result name="success" type="chain">getSelectionTree</result>
    </action>
    
    <action name="getSelectionTree"
      class="org.hisp.dhis.dataadmin.action.NoAction">
      <result name="success" type="velocity">
        /dhis-web-maintenance-dataadmin/selectionedTreeInFrame.vm</result>
      <param name="javascripts">javascript/oust.js,javascript/locking.js,javascript/dataElementsList.js,javascript/associations.js</param>
    </action>
    
    <!-- Maintenance -->
  
    <action name="displayMaintenanceForm" class="org.hisp.dhis.dataadmin.action.NoAction">
      <result name="success" type="velocity">/main.vm</result>
      <param name="page">/dhis-web-maintenance-dataadmin/maintenanceForm.vm</param>
      <param name="menu">/dhis-web-maintenance-dataadmin/menu.vm</param>
      <param name="javascripts">javascript/maintenance.js</param>
    </action>
    
    <action name="performMaintenance" class="org.hisp.dhis.dataadmin.action.maintenance.PerformMaintenanceAction">
      <result name="success" type="velocity-xml">/dhis-web-maintenance-dataadmin/responseSuccess.vm</result>
      <param name="onExceptionReturn">plainTextError</param>
    </action>
    
    <!-- Resource table -->
    
    <action name="displayResourceTableForm" class="org.hisp.dhis.dataadmin.action.NoAction">
      <result name="success" type="velocity">/main.vm</result>
      <param name="page">/dhis-web-maintenance-dataadmin/resourceTableForm.vm</param>
      <param name="menu">/dhis-web-maintenance-dataadmin/menu.vm</param>
      <param name="javascripts">javascript/resourceTable.js</param>
    </action>
    
    <action name="generateResourceTable" class="org.hisp.dhis.dataadmin.action.resourcetable.GenerateResourceTableAction">
      <result name="success" type="velocity-xml">/dhis-web-maintenance-dataadmin/responseSuccess.vm</result>
      <param name="onExceptionReturn">plainTextError</param>
    </action>
    
    <!-- Cache -->
    
    <action name="showCache" class="org.hisp.dhis.dataadmin.action.cache.ShowCacheAction">
      <result name="success" type="velocity">/main.vm</result>
      <param name="page">/dhis-web-maintenance-dataadmin/showcache.vm</param>
      <param name="menu">/dhis-web-maintenance-dataadmin/menu.vm</param>
      <interceptor-ref name="organisationUnitTreeStack"/>
    </action>
    
    <action name="clearCache" class="org.hisp.dhis.dataadmin.action.cache.ClearCacheAction">
      <result name="success" type="redirect">showCache.action</result>
    </action>
    
    <!-- Data integrity -->
    
    <action name="displayDataIntegrityForm" class="org.hisp.dhis.dataadmin.action.dataintegrity.GetDataIntegrityAction">
      <result name="success" type="velocity">/main.vm</result>
      <param name="page">/dhis-web-maintenance-dataadmin/dataIntegrityForm.vm</param>
      <param name="menu">/dhis-web-maintenance-dataadmin/menu.vm</param>
    </action> 
    
    <!-- Statistics -->
    
    <action name="viewStatistics" class="org.hisp.dhis.dataadmin.action.statistics.GetStatisticsAction">
      <result name="success" type="velocity">/main.vm</result>
      <param name="page">/dhis-web-maintenance-dataadmin/viewStatistics.vm</param>
      <param name="menu">/dhis-web-maintenance-dataadmin/menu.vm</param>
    </action>
    
    <action name="viewStatisticsChart" class="org.hisp.dhis.dataadmin.action.statistics.GetStatisticsChartAction">
      <result name="success" type="chart">
        <param name="width">420</param>
        <param name="height">220</param>
      </result>   
    </action>
    
    <!-- Databrowser -->
     
    <action name="displayDataBrowserForm" class="org.hisp.dhis.dataadmin.action.databrowser.GetPeriodTypesAction">
      <result name="success" type="velocity">/main.vm</result>
      <param name="page">/dhis-web-maintenance-dataadmin/dataBrowserForm.vm</param>
      <param name="menu">/dhis-web-maintenance-dataadmin/menu.vm</param>
      <param name="javascripts">
        ../dhis-web-commons/ouwt/ouwt.js,
        ../dhis-web-commons/calendar/calendar.js,
        ../dhis-web-commons/calendar/calendar-lang.js,
        ../dhis-web-commons/calendar/calendar-setup.js,
        javascript/dataBrowser.js
      </param>
      <interceptor-ref name="organisationUnitTreeStack"/>   
    </action>
    
    <action name="searchResult" class="org.hisp.dhis.dataadmin.action.databrowser.SearchAction">
      <result name="success" type="velocity">/main.vm</result>
      <result name="error" type="redirect">error.action</result>
      <param name="page">/dhis-web-maintenance-dataadmin/dataBrowserResult.vm</param>
      <param name="menu">/dhis-web-maintenance-dataadmin/menu.vm</param>
    </action>
    
    <action name="error" class="org.hisp.dhis.dataadmin.action.NoAction">
      <result name="success" type="velocity">/main.vm</result>
      <param name="page">/dhis-web-maintenance-dataadmin/dataBrowserError.vm</param>
      <param name="menu">/dhis-web-maintenance-dataadmin/menu.vm</param>
    </action>
    
    <action name="exportPDF" class="org.hisp.dhis.dataadmin.action.databrowser.ExportPDFAction">
      <result name="success" type="stream">
        <param name="contentType">application/pdf</param>
        <param name="inputName">inputStream</param>
        <param name="contentDisposition">attachment;filename="${fileName}"</param>
        <param name="bufferSize">10240</param>
      </result>
    </action>
    
    <!-- Outlier analysis -->
    
    <action name="outlierAnalysisForm" class="org.hisp.dhis.dataadmin.action.outlieranalysis.OutlierFormAction">
      <result name="success" type="velocity">/main.vm</result>        
      <param name="page">/dhis-web-maintenance-dataadmin/outlierForm.vm</param>
      <param name="menu">/dhis-web-maintenance-dataadmin/menu.vm</param>
      <param name="javascripts">
        ../dhis-web-commons/ouwt/ouwt.js,
        ../dhis-web-commons/oust/oust.js,
        ../dhis-web-commons/calendar/calendar.js,
        ../dhis-web-commons/calendar/calendar-lang.js,
        ../dhis-web-commons/calendar/calendar-setup.js,
        ../dhis-web-commons/lists/lists.js,
        javascript/outlierAnalysis.js
      </param>
      <interceptor-ref name="organisationUnitTreeStack"/>
    </action>
    
    <action name="searchOutlierResult" class="org.hisp.dhis.dataadmin.action.outlieranalysis.GetOutliersAction">
      <result name="success" type="velocity">/main.vm</result>
      <param name="page">/dhis-web-maintenance-dataadmin/outlierSearchResult.vm</param>
      <param name="menu">/dhis-web-maintenance-dataadmin/menu.vm</param>
      <param name="javascripts">javascript/outlierAnalysisEditValue.js</param>
    </action>
    
    <action name="editOutlier" class="org.hisp.dhis.dataadmin.action.outlieranalysis.EditOutlierAction">
      <result name="success" type="velocity">responseStatus.vm</result>
      <result name="error" type="velocity">responseStatus.vm</result>
    </action>
    
  </package>
</struts>
