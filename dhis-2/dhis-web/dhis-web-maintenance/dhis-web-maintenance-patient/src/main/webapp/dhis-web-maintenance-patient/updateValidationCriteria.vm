<script>
//-----------------------------------------------------------------------
//init jQuery validation for addPatientAttributeForm
//-----------------------------------------------------------------------
	jQuery(document).ready(
			function()
			{
				jQuery("#validationCriteriaForm").validate({
					 meta:"validate"
					,errorElement:"td"
					,submitHandler: function(form)
									{
										validateCriteria();
									}
				});
				jQuery.validator.setMessages( validationMessage );
				jQuery("#name").focus();
			}
	);
</script>
<input type="hidden" id="curLocaleCode" value="$locale.getLanguage()_$locale.getCountry()"/>																		

<h3>$i18n.getString( "update_validation_criteria" )</h3>

<form id="validationCriteriaForm" action="updateValidationCriteria.action" method="post" >
  <table border="0">
	<input type='hidden' id='id' name='id' value='$validationCriteria.id'>
	<tr>
      <th colspan="3">$i18n.getString('criteria_details')</th>
    </tr>
    <tr>
      <td><label>$i18n.getString('name')<em title="$i18n.getString( "required" )"  class="required">*</em></label></td>
      <td colspan="2"><input type='text' id='name' name='name' style='width: 20em' value="$validationCriteria.name" class="{validate:{required:true,rangelength:[2,160]}}"></td>
    </tr>
    <tr>
      <td><label>$i18n.getString('description')</label></td>
      <td colspan="2"><input type='text' id='description' name='description' style='width: 20em' value="$validationCriteria.description"></td>
    </tr>
    <tr>
      <td><label>$i18n.getString('criteria')<em title="$i18n.getString( "required" )"  class="required">*</em></label></td>
      <td><select id='property' name='property' style='width: 8em' onChange="showDivValue();">
		   <option value="">[$i18n.getString( "please_select" )]</option>
		   <option value="gender" #if("$validationCriteria.property" == "gender") selected #end>$i18n.getString( "gender" )</option>
	       <option value="birthDate" #if("$validationCriteria.property" == "birthDate") selected #end>$i18n.getString( "date_of_birth" )</option>
		   <option value="integerValueOfAge" #if("$validationCriteria.property" == "integerValueOfAge") selected #end>$i18n.getString( "age" )</option>
		   <option value="birthDateEstimated" #if("$validationCriteria.property" == "birthDateEstimated") selected #end>$i18n.getString( "estimated" )</option>
		   <option value="bloodGroup" #if("$validationCriteria.property" == "bloodGroup") selected #end>$i18n.getString( "blood_group" )</option>
      </select>
        <select id='operator' name='operator' style='width: 3.5em'>
          <option value='-1' #if( "$validationCriteria.operator"=='-1') selected #end>$i18n.getString('operator_less_then')</option>
          <option value='0'  #if( "$validationCriteria.operator"=='0') selected #end>$i18n.getString('operator_equal_to')</option>
          <option value='1'  #if( "$validationCriteria.operator"=='1') selected #end>$i18n.getString('operator_greater_then')</option>
        </select></td>
      
	  <td><input type='hidden' id='value' name='value' style='width: 8em' value="$validationCriteria.value" class="{validate:{required:true,rangelength:[1,160]}}">
	  <!-- gender -->
		<div id="genderDiv" style="display:none">
			<select id='genderValue' name='genderValue' onChange="fillValue(this.value);" style="width: 8em">
				<option value="">[$i18n.getString( "please_select" )]</option>
				<option value="M" >$i18n.getString( "male" )</option>
				<option value="F">$i18n.getString( "female" )</option>
			</select>
		</div>
		
		<!-- age -->
		<div id="integerValueOfAgeDiv" style="display:none ">
			<input type="text" id='integerValueOfAgeValue' name='integerValueOfAgeValue' onChange="fillValue(this.value);"  style="width: 8em">
		</div>
		
		<!-- birthDate -->
		<div id="birthDateDiv" style="display:none ">
			<input type="text" id="birthDateValue" name="birthDateValue" onChange="fillValue(this.value);"style="width: 6em">			
			<script type="text/javascript">
				datePickerValid( 'birthDateValue' );
			</script> 
		</div>
		
		<!-- birthDateEstimated -->
		<div id="birthDateEstimatedDiv" style="display:none ">
			<select id='birthDateEstimatedValue' name='birthDateEstimatedValue' onChange="fillValue(this.value);" style="width: 8em">
				<option value="">[$i18n.getString( "please_select" )]</option>
				<option value="true">$i18n.getString( "yes" )</option>
				<option value="false">$i18n.getString( "no" )</option>
			</select>
		</div>
		
		<!-- bloodGroup -->
		<div id="bloodGroupDiv" style="display:none ">
			<select id="bloodGroupValue" name="bloodGroupValue" onChange="fillValue(this.value);" style="width: 8em">
				<option value="">[$i18n.getString( "please_select" )]</option>
				<option value="A+">A+</option>
				<option value="A-">A-</option>
				<option value="AB+">AB+</option>
				<option value="AB-">AB-</option>
				<option value="B+">B+</option>
				<option value="B-">B-</option>
				<option value="O+">O+</option>
				<option value="O-">O-</option>
			</select>
		</div>
	  </td>
    </tr>
   <tr>
      <td>&nbsp;</td>
      <td colspan="2">
		<input type="submit" value="$i18n.getString('save')" style="width:10em">
		<input name="button" type="button" style="width:10em" onClick="javascript: window.location.href = 'validationCriteria.action'" value="$i18n.getString('cancel')"></td>
    </tr>
  </table>
</form>

<span id="message"></span>
<script language="javascript">
	
	var name = '$validationCriteria.property';
	var divName = name+ "Div";
	byId(divName).style.display = 'block';
	
	if(divName == 'birthDateDiv'){
		var year = eval('$validationCriteria.value.getYear()') + 1900;
		var month = eval('$validationCriteria.value.getMonth()' ) + 1;
		month = ( month < 10 ) ? ( '0' + month ) : month;
		var date = '$validationCriteria.value.getDate()';
		date = ( date < 10 ) ? ( '0' + date ) : date;
		
		byId(name + "Value").value = year + '-' + month + '-' + date;
		byId('value').value = byId(name + "Value").value;
	}else{
		byId(name + "Value").value = '$validationCriteria.value';
	}
	
	showDivValue();
	
</script>
