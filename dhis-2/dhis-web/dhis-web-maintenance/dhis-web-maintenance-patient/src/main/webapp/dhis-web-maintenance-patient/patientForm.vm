## Macro for generating the jQuery validation rules 
#macro( validate $type $require )
  #if( $type == "NUMBER" )
  	{validate:{ number:true #if($require), required:true #end }}
  #elseif( $require )
  	{validate:{required:true}}
  #end
#end

<table>	
	<tr>
		<td><label for="registration_date">$i18n.getString( "registration_date" )<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
		<td class="input-column">
			<input type="text" id="registrationDate" name="registrationDate" style="width:28em" class="{validate:{required:true}}"/>
			<script type="text/javascript">
				datePickerValid( 'registrationDate', true );
			</script>    
		</td>		
	</tr>

	<tr>
		<th colspan="2" class="heading-column">$i18n.getString( "demographics" )</th>
	</tr>
	<tr>
		<td><label for="fullName">$i18n.getString( "full_name" )</label></td>
		<td class="input-column" >
			<input type="text" id="fullName" name="fullName" style="width:28em" class="{validate:{required:true, unicodechars:true, rangelength:[7,50]}}"/>
			<img src='../images/search.png' id="searchPatientByNameBtn" name="searchPatientByNameBtn" style="cursor: pointer;" width="20" height="20"/>
		</td>
	</tr>
		
	<tr>
		<td><label for="gender">$i18n.getString( "gender" )<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
		<td class="input-column">
			<select id="gender" name="gender" style="width:28.3em" class="{validate:{required:true}}">
				<option value="" selected="selected">[$i18n.getString( "please_select" )]</option>
				<option value="M" >$i18n.getString( "male" )</option>
				<option value="F">$i18n.getString( "female" )</option>
				<option value="T">$i18n.getString( "transgender" )</option>
			</select>
		</td>		
	</tr>

	<tr>
		<td><label for="dobType">$i18n.getString( "dob_type" )<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
		<td class="input-column">
			<select id='dobType' name="dobType" style="width:28.3em" class="{validate:{required:true}}">
				<option value="V" selected="selected">$i18n.getString( "verified" )</option>
				<option value="D" >$i18n.getString( "declared" )</option>
				<option value="A" >$i18n.getString( "approximated" )</option>
			</select>
		</td>
	   <td></td>
	</tr>

	<tr id='birthdaySpan'>
		<td><label for="birthDate">$i18n.getString( "date_of_birth" )<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
		<td class="input-column">			
			<input type="text" id="birthDate" name="birthDate" style="width:26.5em" />
		</td>
		<td></td>
	</tr>

	<tr id='ageSpan' style="display:none" >
		<td><label for="age">$i18n.getString( "age" ) </label><em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
		<td>
			<select id="ageType" name="ageType" style="width:18em" >
				<option value="D"> $i18n.getString('day')</option>
				<option value="M"> $i18n.getString('month')</option>
				<option value="Y"> $i18n.getString('year')</option>
			</select>
			<input type="text" id="age" name="age" style="width:9.7em" class="{validate:{number:true, alphanumeric: true}}"/>
		</td>
		<td></td>
	</tr>

	<tr>
		<td></td>
		<td><input id="memberValidator" style="display:none" class="{validate:{required:true}}"/></td>
	</tr>

	<tr>
		<td><label for="bloodGroup">$i18n.getString( "blood_group" )</label></td>
		<td class="input-column">
			<select type="text" id="bloodGroup" name="bloodGroup" style="width:28.3em" >
				<option value="">[$i18n.getString( "please_select" )]</option>
				<option value="A+">A+</option>
				<option value="A-">A-</option>
				<option value="AB+">AB+</option>
				<option value="AB-">AB-</option>
				<option value="B+">B+</option>
				<option value="B-">B-</option>
				<option value="O+">O+</option>
				<option value="O-">O-</option>
			</select>
		</td>		
	</tr>
	<tr><td colspan="2">&nbsp;</td></tr>	
	<tr>
		<td></td>
		<td><input type="button" id='checkDuplicateBtn' name='checkDuplicateBtn' value="$i18n.getString('check_duplicate')" /></td>
	</tr>
	<tr><td colspan="2">&nbsp;</td></tr>	

	<!-- UNDERAGE -->
	<tr id='underAgeDiv'>
		<td>$i18n.getString("is_underage")</td>
		<td>
			<input type="checkbox" name="underAge" id="underAge" onclick="toggleUnderAge(this);" value="true"/>
		</td>
	</tr>
	
	<!--IDENTIFIERS -->
	<tr><td colspan="2">&nbsp;</td></tr>	
	<tr><th colspan="2" class="heading-column">$i18n.getString( "patient_identifiers" )</th></tr>
	#foreach ($identifierType in $identifierTypes)
	<tr>
		<td><label>$identifierType.name #if($identifierType.mandatory == true )<em title="$i18n.getString( 'required' )" class="required">*</em> #end</label></td>       
			<td class="input-column">
			<input type="text" style="width:28em" id="iden$identifierType.id" name="iden$identifierType.id" data="{related:$identifierType.related}" class="{validate:{required:$identifierType.mandatory, #if($!identifierType.noChars) maxlength:$identifierType.noChars, #end #if($identifierType.type=='number') number:true #elseif($!identifierType.type=='letter') lettersonly:true #end }}" /></td>
	</tr>
	#end

	<!-- ATTRIBUTES IN GROUPS -->

	#foreach ($attributeGroup in $attributeGroups )
		<tr><td>&nbsp;</td></tr>
		<tr><th colspan="2" class="heading-column">$attributeGroup.name</th></tr>
		#foreach($attribute in $attributeGroup.attributes )
			#if($!attribute)
			<tr>
				<td><label>$attribute.name #if($attribute.mandatory)<em title="$i18n.getString( 'required' )" class="required">*</em> #end</label></td>
				<td class="input-column">
					#if( $attribute.valueType == "YES/NO" )
						<select id="attr$attribute.id" name="attr$attribute.id" style="width:28.3em"> 
							<option value="">[$i18n.getString( "please_select" )]</option>
							<option value="true">$i18n.getString( "yes" )</option>
							<option value="false" selected="selected">$i18n.getString( "no" )</option>
						</select>                
					#elseif( $attribute.valueType == "DATE" )
						<input type="text" id="attr$attribute.id" name="attr$attribute.id" style="width:28em" class=' #validate( "default"  $attribute.mandatory )'/>
						<script type="text/javascript">
							datePickerValid( 'attr$attribute.id' );
						</script>                    
					#elseif( $attribute.valueType == "COMBO" )
						<select  id="attr$attribute.id"  name="attr$attribute.id" style="width:28.3em" class='#validate( "default"  $attribute.mandatory )'>
							<option value="">[$i18n.getString( "please_select" )]</option>
							#foreach ($option in $attribute.attributeOptions )
								<option value="$option.id" >$option.name</option>
							#end
						</select>
					#else 
						<input type="text" id="attr$attribute.id" name="attr$attribute.id" style="width:28em" class="{validate:{required:$attribute.mandatory #if($!attribute.noChars),maxlength:$attribute.noChars #end #if($attribute.valueType=='NUMBER'),number:true #end }}" />
					#end
				</td>		
			</tr>
			#end
		#end
	#end

	<!-- ATTRIBUTES NOT IN GROUPS -->

	<tr><td>&nbsp;</td></tr>
	#if ( $noGroupAttributes.size() > 0) 	
		<tr><th colspan="2" class="heading-column">$i18n.getString( "other_details" )</th></tr>
		#foreach($attribute in $noGroupAttributes )
			<tr>
				<td><label>$attribute.name #if($attribute.mandatory)<em title="$i18n.getString( 'required' )" class="required">*</em> #end</label></td>
				<td class="input-column">
					#if( $attribute.valueType == "YES/NO" )
						<select id="attr$attribute.id"  name="attr$attribute.id" style="width:28.3em" > 
							<option value="" >[$i18n.getString( "please_select" )]</option>             
							<option value="true">$i18n.getString( "yes" )</option>
							<option value="false" >$i18n.getString( "no" )</option>
						</select>                
					#elseif( $attribute.valueType == "DATE" )
							<input type="text" id="attr$attribute.id" name="attr$attribute.id" style="width:28em" class='#validate( "default"  $attribute.mandatory )' />
							<script type="text/javascript">
							   datePickerValid( 'attr$attribute.id' );
							</script>                    
					#elseif( $attribute.valueType == "COMBO" )
						<select  id="attr$attribute.id" name="attr$attribute.id" style="width:28.3em" class='#validate( "default"  $attribute.mandatory )'>
							<option value="">[$i18n.getString( "please_select" )]</option>
							#foreach ($option in $attribute.attributeOptions )
								<option value="$option.id" >$option.name</option>
							#end
						</select>
					#else 
						<input type="text" id="attr$attribute.id" name="attr$attribute.id" style="width:28em" class="{validate:{required:$attribute.mandatory #if($!attribute.noChars),maxlength:$attribute.noChars #end #if($attribute.valueType=='NUMBER'),number:true #end }}" />
					#end
				</td>		
			</tr>
		#end
	#end
</table>
