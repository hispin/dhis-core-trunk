<div class="panel panel-info" ng-controller="DataEntryController">
    <div ng-include="'components/dataentry/dataentry-print.html'">
    </div>
    <div class="panel-heading handle bold">
        {{dataentryWidget.title| translate}}        
        <span class="pull-right widget-link">
            <a href ng-click="toggleEventsTableDisplay()" title="{{showEventsAsTables ? 'toggle_table_view_off' : 'toggle_table_view_on'| translate}}" ng-show="stagesCanBeShownAsTable"><span ng-if="!showEventsAsTables"><i class="fa fa-bars vertical-center"></i></span><span ng-if="showEventsAsTables"><i class="fa fa-square vertical-center"></i></span></a>
            <a href ng-click="filterEvents = !filterEvents" title="{{filterEvents ? 'list_events' : 'filter_events'| translate}}" ng-show="eventFilteringRequired"><span ng-if="!filterEvents"><i class="fa fa-filter vertical-center"></i></span><span ng-if="filterEvents"><i class="fa fa-list vertical-center"></i></span></a>
            <a href ng-click="toggleLegend()" title="{{'event_color_legend'| translate}}" class="small-horizonal-spacing"><i class="fa fa-info-circle vertical-center"></i></a>
            <a class="small-horizonal-spacing" href ng-click="expandCollapse(dataentryWidget)">
                <span ng-show="dataentryWidget.expand"><i class="fa fa-chevron-up vertical-center" title="{{collapseLabel}}"></i></span>
                <span ng-show="!dataentryWidget.expand"><i class="fa fa-chevron-down vertical-center" title="{{expandLabel}}"></i></span>
            </a>
            <a class="small-horizonal-spacing" href ng-click="removeWidget(dataentryWidget)" title="{{removeLabel}}"><i class="fa fa-times-circle vertical-center"></i></a>            
        </span>        
    </div>

    <div ng-show="dataentryWidget.expand" class="panel-body dashboard-widget-container">
        
        <div ng-if="!dashboardReady">
            <img id="ouwt_loader" src="../images/ajax-loader-bar.gif" alt="{{'loading'| translate}}"/>
        </div>
        <div ng-if="dashboardReady">            
        
            <div ng-if="showEventColors">
                <span class='bold'>{{'legend'| translate}}</span>
                <table class="table table-bordered" style="width: 100%;">               
                    <tr>
                        <td ng-class="eventColor.color" ng-repeat="eventColor in eventColors">
                            <span class="bold">{{eventColor.description| translate}}</span>
                        </td>
                    </tr>
                </table>
            </div>

            <div class="table-responsive hideInPrint" ng-if="selectedEnrollment && selectedEnrollment.enrollment">
                <div ng-include="'components/dataentry/event-layout.html'"></div>                
            </div>

            <div ng-if="!selectedEnrollment || !selectedEnrollment.enrollment" class="alert alert-danger">{{notEnrolledLabel}}</div>

            <form name="outerForm" novalidate>
                <div ng-if="currentEvent">

                    <div ng-include="'components/dataentry/event-details.html'"></div>

                    <!-- data entry form begins -->
                    <div ng-if="currentEvent.eventDate">                            
                        <div class="clear vertical-spacing" ng-if="displayCustomForm === 'CUSTOM'" ng-include="'../dhis-web-commons/angular-forms/custom-form.html'"></div>
                        <div class="clear vertical-spacing" ng-if="displayCustomForm === 'DEFAULT'" ng-include="'components/dataentry/default-form.html'"></div>
                    </div>    
                    <!-- the table form is insensitive to the event date being present. In this situation the eventdate is set inside the table form -->
                    <div class="clear vertical-spacing" ng-if="displayCustomForm === 'TABLE'" ng-include="'components/dataentry/table-entry-form.html'"></div>
                    <!-- data entry form ends -->
                    
                    <!-- data entry/event buttons begins -->
                    <div ng-include="'components/dataentry/dataentry-buttons.html'"></div>
                    <!-- data entry/event buttons ends -->                    

                </div>
            </form>

            <div ng-if="displayCustomForm !== 'TABLE'">                
                <div ng-include="'components/dataentry/dataentry-notes.html'"></div>
            </div>
            
        </div>        
        
    </div>        
</div>
