
#macro( expandOrganisationUnit $organisationUnit )
{
"id":$!{organisationUnit.id},
#if( $organisationUnit.parent )"pid":$!{organisationUnit.parent.id},#end
"n":"$!encoder.jsonEncode( ${organisationUnit.name} )"#if( $organisationUnit.children.size() > 0 ),
"c":[
#foreach ( $child in $organisationUnit.sortedChildren )
#expandOrganisationUnit( $child )#if( $velocityCount < $organisationUnit.children.size() ),#end
#end]#end }
#end

{ "version":"$!encoder.jsonEncode( $version )"
#if( ! $versionOnly )
,"organisationUnits":[
#foreach ( $organisationUnit in $organisationUnits )
#expandOrganisationUnit( $organisationUnit )#if( $velocityCount < $organisationUnits.size() ),#end
#end ]
#end }