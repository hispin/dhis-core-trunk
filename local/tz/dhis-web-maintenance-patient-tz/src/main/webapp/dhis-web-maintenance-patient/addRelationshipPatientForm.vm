<script>
	jQuery('#addRelationshipPatientForm').ready(	function(){

		datePickerValid( 'birthDate' );
		
		jQuery("#addRelationshipPatientForm").validate({
			 meta:"validate"
			,errorElement:"span"
			,submitHandler: function(form)
				{
					validateAddRelationshipPatient();
				}
			,beforeValidateHandler: function(form)
				{
					var birthDate = $('#birthDate').val();
					var age = $('#age').val();
					if(age !=''){
						$( "#memberValidator").val(age);
					}else{
						$( "#memberValidator").val(birthDate);
					}
				}
		});
	});		
</script>
<div>
    <input type="button" value="$i18n.getString( "back_to_search" )" onclick="showRelationshipList($patient.id);" style="width:10em">
</div>

<h3>$i18n.getString("add_new_relationship_for"):  $patient.getFullName()</h3>
																		
<form id="addRelationshipPatientForm" action="addRelationshipPatient.action" method="get" >
<input type="hidden" id="relationshipId"  name="relationshipId" value="$patient.id"/> 
<table>	
	<tr>
		<td style='width:14em'><label for="relationship_type">$i18n.getString("relationship_type")<em title="$i18n.getString( "required" )" class="required">*</em></label></td>
		<td class="input-column">
			<select name="relationshipTypeId" id="relationshipTypeId" style="width:28.2em" class="{validate:{required:true}}" >
				<option value="">[$i18n.getString( "please_select" )]</option>        
				#foreach ($relationship in $relationshipTypes)
					<option value="$relationship.id">${relationship.aIsToB} - ${relationship.bIsToA}</option>
				#end
			</select>
		</td>
	</tr>
</table>

#parse( "/dhis-web-maintenance-patient/patientForm.vm" )

<p style="margin-top:10px">
	<input type="submit" value="$i18n.getString( 'add' )" style="width:10em"/>
</p>

</form> 	
	
<div id="hiddenModalContent" style="display:none">
<style> 
div#hiddenModalContent label { font-weight: bold;}  
div#hiddenModalContent td {padding: 2px 5px}
</style>
<span>$i18n.getString( "duplicate_warning" )</span>
<input type="button" value="$i18n.getString( 'create_new_patient' )"  id="btnCreateNew"/>

<div id="thickboxContainer"></div>
</div>

<script type="text/javascript">
	var i18n_patient_identifiers = '$encoder.jsEscape( $i18n.getString( "patient_identifiers" ) , "'")';
	var i18n_patient_attributes = '$encoder.jsEscape( $i18n.getString( "patient_attributes" ) , "'")';
	var i18n_patient_fullName = '$encoder.jsEscape( $i18n.getString( "full_name" ) , "'")';
	var i18n_patient_demographics = '$encoder.jsEscape( $i18n.getString( "demographics" ) , "'")';
	var i18n_patient_gender = '$encoder.jsEscape( $i18n.getString( "gender" ) , "'")';
	var i18n_patient_date_of_birth = '$encoder.jsEscape( $i18n.getString( "date_of_birth" ) , "'")';
	var i18n_patient_age = '$encoder.jsEscape( $i18n.getString( "age" ) , "'")';
	var i18n_patient_blood_group = '$encoder.jsEscape( $i18n.getString( "blood_group" ) , "'")';
	var i18n_edit_this_patient = '$encoder.jsEscape( $i18n.getString( "edit_this_patient" ) , "'")';
	var i18n_no_duplicate_found = '$encoder.jsEscape( $i18n.getString( "no_duplicate_found" ) , "'")';
	var i18n_patient_system_id = '$encoder.jsEscape( $i18n.getString( "patient_system_id" ) , "'")';
	var i18n_child_representative = '$encoder.jsEscape( $i18n.getString( "child_representative" ) , "'")';
	var i18n_no_patients_found = '$encoder.jsEscape( $i18n.getString( "no_patients_found" ) , "'")';
	var i18n_search_result = '$encoder.jsEscape( $i18n.getString( "search_result" ) , "'")';
	var checkedDuplicate = false;
</script>