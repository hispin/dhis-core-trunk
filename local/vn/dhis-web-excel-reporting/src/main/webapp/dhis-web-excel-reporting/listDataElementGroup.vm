<h3>$i18n.getString('dataelement_groups')</h3>
<div id="tooltip"></div>
<p></p>
<table width="800px">
	<tr>
		<td colspan=2>
			<input type="button" onclick="openAddDataElementGroupOrder()" value="$i18n.getString('add')" style="width:100px"/>
			<input type="button" value="$i18n.getString( 'cancel' )" onclick="window.location='listAllExportReport.action'" style="width:100px">
		</td>
		<td width="100px">
			<input type="button" value="$i18n.getString( 'update_order' )" onclick="updateDataElementGroupOrder()" style="width:150px">
		</td>
	</tr>
	<tr>
		<th>$i18n.getString('name')</th>	
		<th width="100px">$i18n.getString('code')</th>			
		<th width="100px">$i18n.getString('operations')</th>		
	</tr>	
</table>


<ul id="sortable"> 
#foreach($group in $exportReport.dataElementOrders)
	<li class="ui-state-default" name="dataElementGroupOrder" value="$group.id" title="$i18n.getString( 'sort_order_help' )">		
		<table cellspacing="0" cellpadding="0" width="100%">
			<tr>
				<td>$encoder.htmlEncode( $group.name )</td>
				<td width="100px">$encoder.htmlEncode( $group.code )</td>
				<td width="100px">
					<a href="javascript:deleteDataElementOrder('$group.id');" title="$i18n.getString( 'remove' )"><img src="../images/delete.png" alt="$i18n.getString( 'remove' )"></a>
					<a href="javascript:openUpdateDataElementOrder( '$group.id' );" title="$i18n.getString( 'edit' )"><img src="../images/edit.png" alt="$i18n.getString( 'edit' )"></a>
					<a href="openSortDataElement.action?id=$group.id" title="$i18n.getString( 'sort_dataelement' )"><img src="../images/sort.png" border="1px"/></a>
				</td>
			</tr>
		</table>		
	
	</li> 	
#end
</ul> 

<div id="dataElementGroups">
<form name="dataElementGroups" id="dataElementGroupsForm" method="POST">
<input type="hidden" name="id" value="$exportReport.id"/>
<input type="hidden" name="dataElementGroupOrderId" id="dataElementGroupOrderId"/>
	<table>
		<tr>
			<td>$i18n.getString('name')</td>
			<td><input type="text" style="width:400px" id="name" name="name" class="{validate:{required:true}}"/></td>
		</tr>
		<tr>
			<td>$i18n.getString('code')</td>
			<td><input type="text" style="width:400px" id="code" name="code" class="{validate:{required:true}}"/></td>
		</tr>
	</table>		
	<br/>		
	<table width="100%">		
		<tr>
			<td colspan="4">
				<select id="availableDataElementGroups" onchange="dataDictionary.loadDataElementsByGroup( this.value , '#availableDataElements' )" style="width:300px"></select>
			</td>			
		</tr>
		<tr>
		  <td width="23%">
			<select id="availableDataElements" name="availableDataElements" multiple size=13 style="width:300px" ondblclick="moveSelectedById('availableDataElements','dataElementIds');"></select>
			</td>
			<td width="7%" align="center">
				<input type="button" value="&gt;" onclick="moveSelectedById('availableDataElements','dataElementIds');" style="width:50px"/><br>
				<input type="button" value="&lt;" onclick="moveSelectedById('dataElementIds' , 'availableDataElements' );" style="width:50px"/><br>
				<input type="button" value="&gt;&gt;" onclick="moveAllById('availableDataElements' , 'dataElementIds' );" style="width:50px"/><br>
				<input type="button" value="&lt;&lt;" onclick="moveAllById('dataElementIds' , 'availableDataElements' );" style="width:50px"/>
			</td>
			<td width="23%">
				<select id="dataElementIds" name="dataElementIds" multiple size=13 style="width:300px" ondblclick="moveSelectedById('dataElementIds' , 'availableDataElements' );"/>
				<select id="dataElementIdsValidate"  style="display:none" class="{validate:{required:true}}"/>
			</td>
		    <td width="47%"><a href="javascript:moveSelectedOptionToTop( 'dataElementIds' );"><img src="../images/move_top.png" style="cursor: pointer; width: 20px;" align="absmiddle"></a><br><br>			
			<a href="javascript:moveUpSelectedOption( 'dataElementIds' );"><img src="../images/move_up.png" style="cursor: pointer; width: 20px;" align="absmiddle"></a><br><br>		
			<a href="javascript:moveDownSelectedOption( 'dataElementIds' );"><img src="../images/move_down.png" style="cursor: pointer; width: 20px;" align="absmiddle"></a><br><br>		
			<a href="javascript:moveSelectedOptionToBottom( 'dataElementIds' );"><img src="../images/move_bottom.png" style="cursor: pointer; width: 20px;" align="absmiddle"></a>			
		</td>
		</tr>
	</table>
		
	<p align=center>
		<input type="submit" value="$i18n.getString( 'save' )" style="width:130px"/>		
		<input type="button" value="$i18n.getString( 'cancel' )" style="width:130px" onclick="jQuery('#dataElementGroups').dialog('close')"/>		
	</p>
</form>
</div>

<script>
	var i18n_confirm_delete = '$encoder.jsEscape($i18n.getString( 'confirm_delete' ) , "'")';	
	var i18n_name_is_null = '$encoder.jsEscape($i18n.getString( 'i18n_name_is_null' ) , "'")';		
	var reportId = $exportReport.id;
	$(function() {
		$("#sortable").sortable({
			placeholder: 'ui-state-highlight'
		});
		$("#sortable").disableSelection();
		
	});
	
	jQuery("#dataElementGroups").dialog({autoOpen:false,width:720,title:"$i18n.getString('dataelement_groups')"});
	
	validation( "dataElementGroupsForm", function( form ){ form.submit() }, function(){
		listValidator( 'dataElementIdsValidate', 'dataElementIds' );
	});
	
</script>