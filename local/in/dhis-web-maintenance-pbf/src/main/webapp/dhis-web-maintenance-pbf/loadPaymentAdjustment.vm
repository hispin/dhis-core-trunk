
<script type="text/javascript" >
	var total = 0;
	var windowWidth = $(window).width();
	var windowHeight = $(window).height();
	var tableWidth = (parseInt( windowWidth ) * 75) / 100 ;	
	var columnWidth = (parseInt( windowWidth ) * 10) / 100 ;
	var indicatorWidth = (parseInt( windowWidth ) * 15) / 100 ;
	Ext.Loader.setConfig({
		enabled: true
	});
	Ext.Loader.setPath('Ext.ux.grid', 'javascript');
	Ext.require([
		'Ext.data.*',
		'Ext.grid.*',
		'Ext.toolbar.Paging',
		'Ext.ux.grid.TransformGrid'
	]);
	
</script>

<script >
$(function() {
			Ext.QuickTips.init();
			
			var grid = Ext.create('Ext.ux.grid.TransformGrid', "paymentDetails", {				
			sortableColumns: true,
            enableColumnMove: true,
            enableColumnResize: true,
            sortOnLoad: true,
			width: tableWidth,
        	height: 200,			
            sorters: {direction: 'ASC'},
			autoCreateViewPort:false,
			renderTo: Ext.Element.get('#paymentTable'),
        	layout: {
            	type: 'hbox',
            	align: 'stretch'
        	},
			columns: [
    		{
                text     : '$i18n.getString( "indicator" )',
    			width    : indicatorWidth,            
                sortable : true
            },
			{
                text     : '$i18n.getString( "quantity_for" )',
    			width    : columnWidth,            
                sortable : true
            },
			{
                text     : '$i18n.getString( "Tariff" )',
    			width    : columnWidth,						
                sortable : true
            },
			{
                text     : '$i18n.getString( "amount" )',
    			width    : columnWidth,						
                sortable : true
            },
			{
                text     : '$i18n.getString( "amount_including_quality" )',
    			width    : columnWidth,						
                sortable : true
            },
			{
                text     : '$i18n.getString( "adjusted_per" )',
    			width    : columnWidth,						
                sortable : true
            },
			{
                text     : '$i18n.getString( "adjusted_per" )',
    			width    : columnWidth,						
                sortable : false
            }
			]
			});
			
			grid.render();

});
</script>
<style >
	.mandatory
	{
		color:red;
		font-size: 1.5em;
	}
</style>

<input type="hidden" id="dataElementId" name="dataElementId" value="$!selecteddataElement.id"/>
<div style="width:100%;" id="paymentTable">
<table id="paymentDetails" name="paymentDetails" cellspacing="0">
	<thead >
		<tr >
			<th >$i18n.getString( "indicator" )</th>
			<th >$i18n.getString( "quantity_for" )</th>
			<th >$i18n.getString( "Tariff" )</th>			
			<th >$i18n.getString( "amount" )</th>
			<th >$i18n.getString( "amount_including_quality" )</th>
			<th >$i18n.getString( "adjusted_per" )</th>
			<th >$i18n.getString( "adjusted_per" )</th>
        </tr>
	</thead>
	<tbody>
		#set( $mark = false )
		#foreach( $dataElement in $dataElements )
			#if( $mark )
                #set( $mark = false )
			#else
				#set( $mark = true )
			#end
			
            <tr >
				<td>$!dataElement.name</td>
				<td>$!quantityValidatedMap.get( $dataElement.uid )</td>
				<td>$!tariffDataValueMap.get( $dataElement.uid )</td>				
				<td id="amount_$dataElement.id"></td>
				<td>&nbsp; </td>
				<td>&nbsp;</td>
	            <td>&nbsp;</td>		            		
        </tr>
        <script>
        	function calVal( ) {
        		var amount = 0.0;
        		amount = parseFloat( '$!quantityValidatedMap.get( $dataElement.uid )' ) * parseFloat( '$!tariffDataValueMap.get( $dataElement.uid )' );
        		$('#amount_'+$dataElement.id).text( amount.toFixed(2) );
        		total = total + parseFloat( amount  );
        		document.getElementById("total").value = total.toFixed(2) ;
        	}
        	calVal( );
        </script>
		#end
		<tr>
			<td>&nbsp; </td>			
			<td colspan="2" >Unadjusted Amount </td>
			<td colspan="2"><input type="text" name="total" id="total"/></td>
			<td>&nbsp; </td>
			<td>&nbsp; </td>>
		</tr>
    </tbody>
</table>
</div>